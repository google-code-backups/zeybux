function MenuVue(){this.mMenuTemplate=new IdentificationTemplate();this.construct=function(){var a=this;$.post("./index.php?m=Identification&v=Menu",function(b){Infobulle.init();if(b.valid){a.afficherNouveau(b)}else{Infobulle.generer(b,"")}},"json")};this.afficherNouveau=function(b){var a=this;$("#menu_int").replaceWith(a.genererNouveauMenu(b.menu));$("#site").append(a.genererLienDeconnexion());if(b.admin){$("#site").append(a.affectAdministration(a.genererLienAdmin()))}};this.genererLienDeconnexion=function(){return $(this.mMenuTemplate.deconnexion).hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")})};this.genererLienAdmin=function(){return $(this.mMenuTemplate.administration).hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")})};this.genererNouveauMenu=function(b){var a=this.mMenuTemplate.debutMenu;a+=this.genererNouveauModule(b);a+=this.mMenuTemplate.finMenu;a=$(a);a.find(".menu-lien").first().addClass("ui-corner-tl");a.find(".menu-lien").last().addClass("ui-corner-br");a.find(".menu-lien").hover(function(){a.find(".menu-lien").removeClass("ui-state-hover");$(this).addClass("ui-state-hover")},function(){a.find(".menu-lien").removeClass("ui-state-hover")});a=this.affectVues(a);return a};this.affectHover=function(a){a.hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")});return a};this.genererNouveauModule=function(a){var b=this.mMenuTemplate.nouveauModule;return b.template(a)};this.affectAdministration=function(a){a.click(function(){AdministrationVue()});a=this.affectHover(a);return a};this.afficher=function(b){var a=this;$("#menu_int").replaceWith(a.genererMenu(b));$("#site").append(a.mMenuTemplate.deconnexion)};this.genererMenu=function(b){var a=this.mMenuTemplate.debutMenu;a+=this.genererModule(b);a+=this.mMenuTemplate.finMenu;a=$(a);a=this.affectVues(a);a=this.affectAnimation(a);return a};this.genererModule=function(a){var b=this.mMenuTemplate.module;return b.template(a)};this.affectVues=function(a){if(a){a.find("#menu-MonCompte-MonCompte").click(function(){MonCompteVue();return false});a.find("#menu-MonCompte-MesCommandes").click(function(){ListeReservationVue();return false});a.find("#menu-Commande-ListeCommande").click(function(){ListeCommandeVue();return false});return a}return null};this.construct()}function AdministrationVue(){this.construct=function(){var a=this;$.post("./index.php?m=Identification&v=Administration",function(b){Infobulle.init();if(b.valid){a.afficher(b);var c=new CommunVue();c.majMenu("administration")}else{Infobulle.generer(b,"")}},"json")};this.afficher=function(a){var b=this;var d=new IdentificationTemplate();var c=d.admin;$("#contenu").replaceWith(b.affect($(c.template(a.menu))))};this.affect=function(a){a=this.affectVues(a);return a};this.affectVues=function(a){if(a){a.find("#menu-GestionAdherents-AjoutAdherent").click(function(){AjoutAdherentVue();return false});a.find("#menu-GestionAdherents-ListeAdherent").click(function(){ListeAdherentVue();return false});a.find("#menu-GestionCommande-ListeCommande").click(function(){GestionListeCommandeVue();return false});a.find("#menu-GestionCommande-AjoutCommande").click(function(){AjoutCommandeVue();return false});return a}return null};this.construct()}function IdentificationVue(){this.construct=function(){this.affect()};this.affect=function(){var a=this;$("#identification-form").submit(function(){a.identifier($(this));return false})};this.identifier=function(c){var a=new IdentificationVO();a={login:c.find(":input[name=login]").val(),pass:c.find(":input[name=pass]").val()};var b=new IdentificationValid();var d=b.validAjout(a);Infobulle.init();if(d.valid){$.post("./index.php?m=Identification&v=Identification","pParam="+$.toJSON(a),function(e){Infobulle.init();if(e.valid){MenuVue();MonCompteVue()}else{Infobulle.generer(e,"")}},"json")}else{Infobulle.generer(d)}};this.construct()}$(document).ready(function(){IdentificationVue()});