function TemplateData(){this.infobulle='<!-- BEGIN membres --><div class="com-infobulle com-widget-window ui-widget ui-widget-content ui-corner-all" id="ifb-{membres.nom}"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Erreur : {membres.nom}</div><!-- BEGIN erreurs --><div class="com-widget-content"><ul><li>N°{membres.erreurs.code} : {membres.erreurs.message}</li></ul></div><!-- END erreurs --></div><!-- END membres -->';this.infobulleLog="<!-- BEGIN erreurs --><ul><li>N°{erreurs.code} : {erreurs.message}</li></ul><!-- END erreurs -->"}String.prototype.checkLength=function(b,a){return !(this.toString().length>a||this.toString().length<b)};Number.prototype.checkLength=function(b,a){return !(this.toString().length>a||this.toString().length<b)};String.prototype.isEmpty=function(){return !(this.toString().length>0)};Number.prototype.isEmpty=function(){return !(this.toString().length>0)};String.prototype.isInt=function(){return !isNaN(parseInt(this.toString()))};Number.prototype.isInt=function(){return !isNaN(parseInt(this.toString()))};String.prototype.isFloat=function(){return !isNaN(parseFloat(this.toString()))};Number.prototype.isFloat=function(){return !isNaN(parseFloat(this.toString()))};function isArray(a){if(a){return a.constructor==Array}return false}String.prototype.checkRegexp=function(b){var a=new RegExp(b);return a.test(this.toString())};String.prototype.checkCourriel=function(){var a=/^[\w.-]+@[\w.-]+\.[a-zA-Z]{2,6}$/g;return this.toString().checkRegexp(a)};String.prototype.checkTime=function(){var a=/^[0-9]{2}[:]{1}[0-9]{2}[:]{1}[0-9]{2}$/g;return this.toString().checkRegexp(a)};String.prototype.checkTimeExist=function(){var a=this.toString().split(":");if(a.length==3){return parseInt(a[0])>=0&&parseInt(a[0])<24&&parseInt(a[1])>=0&&parseInt(a[1])<60&&parseInt(a[2])>=0&&parseInt(a[2])<60}return false};String.prototype.checkDate=function(a){if(a===""){a="db"}if(a=="db"){var b=/^[0-9]{4}[-]{1}[0-9]{2}[-]{1}[0-9]{2}$/g}else{if(a=="fr"){var b=/^[0-9]{2}[/]{1}[0-9]{2}[/]{1}[0-9]{4}$/g}else{return false}}return this.toString().checkRegexp(b)};String.prototype.checkDateExist=function(type){if(type===""){type="db"}if(type=="db"){var lSplit="-";var lIndexAnnee=0;var lIndexDate=2}else{if(type=="fr"){var lSplit="/";var lIndexAnnee=2;var lIndexDate=0}else{return false}}var ladate=this.toString().split(lSplit);if((ladate.length!=3)||isNaN(parseInt(ladate[0]))||isNaN(parseInt(ladate[1]))||isNaN(parseInt(ladate[2]))){return false}var unedate=new Date(eval(ladate[lIndexAnnee]),eval(ladate[1])-1,eval(ladate[lIndexDate]));var annee=unedate.getYear();if((Math.abs(annee)+"").length<4){annee=annee+1900}return((unedate.getDate()==eval(ladate[lIndexDate]))&&(unedate.getMonth()==eval(ladate[1])-1)&&(annee==eval(ladate[lIndexAnnee])))};String.prototype.checkDateTime=function(){var a=this.toString().split(" ");if(a.length==2){return(a[0].checkDate("db")&&a[1].checkTime())}return false};String.prototype.checkDateTimeExist=function(){var a=this.toString().split(" ");if(a.length==2){return(a[0].checkDateExist("db")&&a[1].checkTimeExist())}return false};function dateTimeEstPLusGrandeEgale(k,c,e){if(e===""){e="db"}if(e=="db"){var h="-";var l=0;var g=2}else{if(e=="fr"){var h="/";var l=2;var g=0}else{return false}}if(k.checkDateTime(e)&&c.checkDateTime(e)&&k.checkDateTimeExist(e)&&c.checkDateTimeExist(e)){var d=k.split(" ");var j=d[0].split(h);var b=d[1].replace(":","");j=j[l]+j[1]+j[g]+b;var f=c.split(" ");var a=f[0].split(h);var b=f[1].replace(":","");a=a[l]+a[1]+a[g]+b;return j>=a}return false}function dateEstPLusGrandeEgale(a,g,c){if(c===""){c="db"}if(c=="db"){var b="-";var e=0;var f=2}else{if(c=="fr"){var b="/";var e=2;var f=0}else{return false}}if(a.checkDate(c)&&g.checkDate(c)&&a.checkDateExist(c)&&g.checkDateExist(c)){var h=a.split(b);h=h[e]+h[1]+h[f];var d=g.split(b);d=d[e]+d[1]+d[f];return h>=d}return false}function timeEstPLusGrandeEgale(a,c){if(a.checkTime()&&c.checkTime()&&a.checkTimeExist()&&c.checkTimeExist()){var d=a.replace(":","");var b=c.replace(":","");return d>=b}return false}const ERR_101_CODE=101;const ERR_101_MSG="La valeur entrée est trop longue.";const ERR_102_CODE=102;const ERR_102_MSG="Le format du courriel n'est pas valide.";const ERR_103_CODE=103;const ERR_103_MSG="Le format de la date n'est pas valide.";const ERR_104_CODE=104;const ERR_104_MSG="Lidentifiant de l'objet n'est pas valide.";const ERR_105_CODE=105;const ERR_105_MSG="La date saisie n'existe pas.";const ERR_106_CODE=106;const ERR_106_MSG="Le format de l'heure n'est pas valide.";const ERR_107_CODE=107;const ERR_107_MSG="L'heure saisie n'existe pas.";const ERR_108_CODE=108;const ERR_108_MSG="Ce champ doit être de type entier.";const ERR_109_CODE=109;const ERR_109_MSG="Ce champ doit être de type float.";const ERR_110_CODE=110;const ERR_110_MSG='Le champ "Lots" doit être de type tableau.';const ERR_111_CODE=111;const ERR_111_MSG='Le champ "Produits" doit être de type tableau.';const ERR_112_CODE=112;const ERR_112_MSG="Des éléments de la commande sont encore en édition.";const ERR_113_CODE=113;const ERR_113_MSG="Problème technique lors de l'enregistrement.";const ERR_114_CODE=114;const ERR_114_MSG="Plusieures lignes dans la base au lieu d'une attendue.";const ERR_115_CODE=115;const ERR_115_MSG="Le champ doit être de type tableau.";const ERR_116_CODE=116;const ERR_116_MSG="Session expirée. Veuillez vous reconnecter.";const ERR_201_CODE=201;const ERR_201_MSG="Ce champ est obligatoire.";const ERR_202_CODE=202;const ERR_202_MSG="La date de fin des commandes doit être avant celle du marché.";const ERR_203_CODE=203;const ERR_203_MSG="L'heure de fin des commandes doit être avant celle du marché.";const ERR_204_CODE=204;const ERR_204_MSG="L'heure de fin du marché doit être après celle du début.";const ERR_205_CODE=205;const ERR_205_MSG="La quantité max par adhérent doit être plus petite que le stock.";const ERR_206_CODE=206;const ERR_206_MSG="La taille du lot doit être plus petite que quantité max par adhérent.";const ERR_207_CODE=207;const ERR_207_MSG="La commande doit comporter au moins un produit.";const ERR_208_CODE=208;const ERR_208_MSG="La date de fin du marché doit être après celle du début.";const ERR_209_CODE=209;const ERR_209_MSG="La date ne doit pas être passée.";const ERR_210_CODE=210;const ERR_210_MSG="Un produit demandé n'existe pas dans le système.";const ERR_211_CODE=211;const ERR_211_MSG="Ce produit est déjà présent dans la commande.";const ERR_212_CODE=212;const ERR_212_MSG="Aucune réservation pour cette commande.";const ERR_213_CODE=213;const ERR_213_MSG="Il faut entrer un prix pour ce produit.";const ERR_214_CODE=214;const ERR_214_MSG="Il faut entrer une quantité pour ce produit.";const ERR_215_CODE=215;const ERR_215_MSG="Ce champ doit être positif.";const ERR_216_CODE=216;const ERR_216_MSG="Aucune donnée pour l'id donné.";const ERR_217_CODE=217;const ERR_217_MSG="Quantité commandée supérieure à la quantité maximale autorisée.";const ERR_218_CODE=218;const ERR_218_MSG="Quantité commandée supérieure à la quantité restant en stock.";const ERR_219_CODE=219;const ERR_219_MSG="Pas de nouvelle commande.";const ERR_220_CODE=220;const ERR_220_MSG="Vous avez déjà une réservation pour cette commande.";const ERR_221_CODE=221;const ERR_221_MSG="Les réservations sont cloturées pour cette commande.";(function(a){a.fn.checkLength=function(c,b){this.removeClass("ui-state-error");if(this.val().length>b||this.val().length<c){this.addClass("ui-state-error");return false}else{return true}};a.fn.checkRegexp=function(b){this.removeClass("ui-state-error");if(!(b.test(this.val()))){this.addClass("ui-state-error");return false}else{return true}};a.fn.inputToText=function(c){this.hide();if(this.context.nodeName=="SELECT"){this.after('<span name="'+this.attr("name")+'">'+this.children("option:selected").text()+"</span>")}else{var b=this.val();if(c==="montant"){b=b.numberFrToDb();if(isNaN(b)||b.isEmpty()){b=0}b=parseFloat(b).nombreFormate(2,","," ")}this.after('<span name="'+this.attr("name")+'">'+b+"</span>")}return this};a.fn.textToInput=function(){this.show();this.next().hide();return this}})(jQuery);Array.max=function(a){return Math.max.apply(Math,a)};Array.min=function(a){return Math.min.apply(Math,a)};function getDateAujourdhuiDb(){lDate=new Date();lAnnee=lDate.getFullYear();lMois=lDate.getMonth()+1;if(lMois<10){lMois="0"+lMois}lJour=lDate.getDate();if(lJour<10){lJour="0"+lJour}return lAnnee+"-"+lMois+"-"+lJour}function getTimeAujourdhuiDb(){lDate=new Date();lHeure=lDate.getHours();if(lHeure<10){lHeure="0"+lHeure}lMinute=lDate.getMinutes();if(lMinute<10){lMinute="0"+lMinute}lSeconde=lDate.getSeconds();if(lSeconde<10){lSeconde="0"+lSeconde}return lHeure+":"+lMinute+":"+lSeconde}function getDateTimeAujourdhuiDb(){return getDateAujourdhuiDb()+" "+getTimeAujourdhuiDb()}String.prototype.nombreFormate=function(a,b,c){return parseFloat(this).nombreFormate(a,b,c)};Number.prototype.nombreFormate=function(l,d,a){var c=String(this),f,m="",b="";if(l==undefined){l=2}if(d==undefined){d="."}if(a==undefined){a=" "}function k(o){var n="";while(o.length%3!=0){o="0"+o}for(f=0;f<o.length;f+=3){if(f==o.length-1){a=""}n+=o.substr(f,3)+a}while(n.substr(0,1)=="0"){n=n.substr(1)}if(n==" "){n="0 "}return n.substr(0,n.lastIndexOf(a))}if(c.indexOf(".")==-1){for(f=0;f<l;f++){b+="0"}m=k(c)+d+b}else{var j=(c.substr(c.indexOf(".")+1));if(j.length>l){var h=j.length-l;var e=1;for(f=0;f<h;f++){e*=10}b=Math.round(Number(j)/e)}else{if(j.length<l){var h=l-j.length;var g="";for(f=0;f<h;f++){g+="0"}b=j+g}else{b=j}}m=k(c.substr(0,c.indexOf(".")))+String(d)+b}return m};String.prototype.template=function(k,e){var c=this.toString();var j=[];function d(l){regexp=new RegExp("<!-- BEGIN (.*?) -->(.*)","g");splits=regexp.exec(l);if(splits!=null){j.push(splits[1]);d(splits[2])}}d(c);for(var b in j){c=c.replace("<!-- BEGIN "+j[b]+" -->","{"+j[b].split(".")[j[b].split(".").length-1]+"{");c=c.replace("<!-- END "+j[b]+" -->","}"+j[b].split(".")[j[b].split(".").length-1]+"}")}regexp=new RegExp("{(\\w*){(.*)}\\1}","g");splits=regexp.exec(c);if(splits){var a=splits[0];var h=splits[1];var f=splits[2];var g="";for(tag in k){if(typeof(tag)=="string"){if(e!=null){lTag=e+"."+tag}else{lTag=tag}regexp=new RegExp("{"+lTag+"}","g");f=f.replace(regexp,k[tag])}}for(tag in k[h]){if(e!=null){lBnameOut=e+"."+h}else{lBnameOut=h}g+=f.template(k[h][tag],lBnameOut)}c=c.replace(a,g);c=c.template(k)}for(tag in k){if(typeof(tag)=="string"){if(e!=null){lTag=e+"."+tag}else{lTag=tag}regexp=new RegExp("{"+lTag+"}","g");c=c.replace(regexp,k[tag])}}return c.replace(/{\w+}/g,"")};function Infobulles(){this.init=function(){$(".com-infobulle").remove();$(".ui-state-error").removeClass("ui-state-error");$("#contenu_message_information").text("");$("#widget_message_information").hide()};this.generation=function(f,a){var c=new Array();c.membres=new Array();if(!f.valid){for(i in f){if(i!="valid"){if(f[i].valid===false&&f[i].erreurs){var d=new Array();d.nom=a+i;d.erreurs=new Array();for(err in f[i].erreurs){var g=new Array();g.code=f[i].erreurs[err].code;g.message=f[i].erreurs[err].message;d.erreurs.push(g)}if(i=="log"||$("#"+a+i).length==0){var b=new Array();b.membres=new Array();b.membres.push(d);$("#contenu_message_information").html($("#contenu_message_information").html()+TemplateData.infobulleLog.template(d));$("#widget_message_information").delay(gTempsTransition).fadeIn(gTempsTransitionUnique)}else{c.membres.push(d);$("#"+a+i).addClass("ui-state-error");Infobulle.afficher($("#"+a+i))}}else{if(!(f[i].valid===true)||(f[i].valid===false&&!f[i].erreurs)){this.generation(f[i],a+i)}}}}}$("body").append(TemplateData.infobulle.template(c))};this.generer=function(b,a){this.init();if(!a){lNomObj=""}else{lNomObj=a}this.generation(b,lNomObj)};this.afficher=function(d){var b;function c(){var l="#ifb-"+d.attr("id");b=$(l);b.hide();var j=d.height()+8;var e=d.width()/2;var k=d.offset();var h=k;h.top=k.top+j;h.left=k.left+e;var g=$("#site").offset();var f=g;if((h.left+b.width())>(f.left+$("#site").width())){h.left-=b.width()}if((h.top+b.height())>(f.top+$("#site").height())){h.top-=(b.height()+2*d.height()+8)}b.css("position","absolute").css("z-index","1000");b.css(h).fadeIn(gTempsTransitionUnique)}function a(){b.stop().fadeTo(0,1).fadeOut(gTempsTransitionUnique)}d.hover(function(){c()},function(){a()})}}String.prototype.dateFrToDb=function(){var a=this.toString();if(a!==""){if(a.checkDateExist("fr")&&a.checkDate("fr")){return a[6]+a[7]+a[8]+a[9]+"-"+a[3]+a[4]+"-"+a[0]+a[1]}}return""};String.prototype.dateDbToFr=function(){var a=this.toString();if(a!==""){if(a.checkDateExist("db")&&a.checkDate("db")){return a[8]+a[9]+"/"+a[5]+a[6]+"/"+a[0]+a[1]+a[2]+a[3]}}return""};String.prototype.numberFrToDb=function(){var a=this.toString();if(a!==""){return a.replace(",",".").replace(" ","")}return""};String.prototype.extractDbDate=function(){var a=this.toString();if(a!==""){return a[0]+a[1]+a[2]+a[3]+a[4]+a[5]+a[6]+a[7]+a[8]+a[9]}return""};String.prototype.extractDbHeure=function(){var a=this.toString();if(a!==""){return a[11]+a[12]}return""};String.prototype.extractDbMinute=function(){var a=this.toString();if(a!==""){return a[14]+a[15]}return""};function CommandeCompleteVO(){this.id="";this.numero="";this.nom="";this.description="";this.dateMarcheDebut="";this.timeMarcheDebut="";this.dateMarcheFin="";this.timeMarcheFin="";this.dateFinReservation="";this.timeFinReservation="";this.archive="";this.produits=new Array()}function RechargementCompteVO(){this.id="";this.montant="";this.typePaiement="";this.champComplementaireObligatoire="";this.champComplementaire=""}function ProduitCommandeVO(){this.id="";this.idNom="";this.nom="";this.description="";this.idCategorie="";this.categorie="";this.descriptionCategorie="";this.unite="";this.qteMaxCommande="";this.qteRestante="";this.lots=new Array()}function ListeReservationCommandeVO(){this.id="";this.commandes=new Array()}function ReservationCommandeVO(){this.id="";this.stoQuantite="";this.stoIdProduit=""}function DetailCommandeVO(){this.id="";this.idProduit="";this.taille="";this.prix=""}function AchatCommandeVO(){this.id="";this.idCompte="";this.produits=new Array();this.rechargement=""}function ProduitAchatVO(){this.id="";this.quantite="";this.prix=""}function DetailCommandeVR(){this.valid=true;this.log=new VRelement();this.id=new VRelement();this.idProduit=new VRelement();this.taille=new VRelement();this.prix=new VRelement()}function ListeReservationCommandeVR(){this.valid=true;this.log=new VRelement();this.id=new VRelement();this.commandes=new Array()}function ProduitCommandeVR(){this.valid=true;this.log=new VRelement();this.id=new VRelement();this.idNom=new VRelement();this.nom=new VRelement();this.description=new VRelement();this.idCategorie=new VRelement();this.categorie=new VRelement();this.descriptionCategorie=new VRelement();this.unite=new VRelement();this.qteMaxCommande=new VRelement();this.qteRestante=new VRelement();this.lots=new Array()}function ReservationCommandeVR(){this.valid=true;this.log=new VRelement();this.id=new VRelement();this.stoQuantite=new VRelement();this.stoIdProduit=new VRelement()}function RechargementCompteVR(){this.valid=true;this.log=new VRelement();this.id=new VRelement();this.montant=new VRelement();this.typePaiement=new VRelement();this.champComplementaireObligatoire=new VRelement();this.champComplementaire=new VRelement()}function VRelement(){this.valid=true;this.erreurs=new Array()}function VRerreur(){this.code="";this.message=""}function TemplateVR(){this.valid=true;this.log=new VRelement()}function CommandeCompleteVR(){this.valid=true;this.log=new VRelement();this.id=new VRelement();this.numero=new VRelement();this.nom=new VRelement();this.description=new VRelement();this.dateMarcheDebut=new VRelement();this.timeMarcheDebut=new VRelement();this.dateMarcheFin=new VRelement();this.timeMarcheFin=new VRelement();this.dateFinReservation=new VRelement();this.timeFinReservation=new VRelement();this.archive=new VRelement();this.produits=new Array()}function ProduitAchatVR(){this.valid=true;this.log=new VRelement();this.id=new VRelement();this.quantite=new VRelement();this.prix=new VRelement()}function AchatCommandeVR(){this.valid=true;this.log=new VRelement();this.id=new VRelement();this.idCompte=new VRelement();this.produits=new Array();this.rechargement=new VRelement()}function AjoutCommandeControleur(){this.valid=function(b){var a=new CommandeCompleteValid();return a.validAjout(b)};this.validAjoutProduit=function(b){var a=new ProduitCommandeValid();return a.validAjout(b)};this.validAjoutProduitSimple=function(b){var a=new ProduitCommandeValid();return a.validAjout(b,"simple")};this.validAjoutLot=function(b){var a=new DetailCommandeValid();return a.validAjout(b)}}function ListeReservationCommandeValid(){this.validAjout=function(b){var c=new ListeReservationCommandeVR();if(isArray(b.commandes)){if(b.commandes.length>0){$(b.commandes).each(function(){var e=new ReservationCommandeValid();var d=e.validAjout(this);if(!d.valid){c.valid=false}c.commandes.push(d)})}else{c.valid=false;c.log.valid=false;var a=new VRerreur();a.code=ERR_207_CODE;a.message=ERR_207_MSG;c.log.erreurs.push(a)}}else{c.valid=false;c.log.valid=false;var a=new VRerreur();a.code=ERR_115_CODE;a.message=ERR_115_MSG;c.log.erreurs.push(a)}return c};this.validDelete=function(b){var c=new ListeReservationCommandeVR();if(isNaN(parseInt(b.id))){c.valid=false;c.id.valid=false;var a=new VRerreur();a.code=ERR_104_CODE;a.message=ERR_104_MSG;c.id.erreurs.push(a)}return c};this.validUpdate=function(b){var d=this.validDelete(b);if(d.valid){var c=new ListeReservationCommandeVR();if(isArray(b.commandes)){if(b.commandes.length>0){$(b.commandes).each(function(){var f=new ReservationCommandeValid();var e=f.validAjout(this);if(!e.valid){c.valid=false}c.commandes.push(e)})}else{c.valid=false;c.log.valid=false;var a=new VRerreur();a.code=ERR_207_CODE;a.message=ERR_207_MSG;c.log.erreurs.push(a)}}else{c.valid=false;c.log.valid=false;var a=new VRerreur();a.code=ERR_115_CODE;a.message=ERR_115_MSG;c.log.erreurs.push(a)}return c}return d}}function ProduitAchatValid(){this.validAjout=function(b){var c=new ProduitAchatVR();if(isNaN(parseInt(b.id))){c.valid=false;c.log.valid=false;var a=new VRerreur();a.code=ERR_104_CODE;a.message=ERR_104_MSG;c.log.erreurs.push(a)}if(!b.quantite.checkLength(0,12)){c.valid=false;c.quantite.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.quantite.erreurs.push(a)}if(b.quantite!=""&&!b.quantite.isFloat()){c.valid=false;c.quantite.valid=false;var a=new VRerreur();a.code=ERR_109_CODE;a.message=ERR_109_MSG;c.quantite.erreurs.push(a)}if(!b.prix.checkLength(0,12)){c.valid=false;c.prix.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.prix.erreurs.push(a)}if(b.prix!=""&&!b.prix.isFloat()){c.valid=false;c.prix.valid=false;var a=new VRerreur();a.code=ERR_109_CODE;a.message=ERR_109_MSG;c.prix.erreurs.push(a)}if((isNaN(b.quantite)||b.quantite==0)&&(!isNaN(b.prix)&&b.prix!=0)){c.valid=false;c.quantite.valid=false;var a=new VRerreur();a.code=ERR_214_CODE;a.message=ERR_214_MSG;c.quantite.erreurs.push(a)}if(b.quantite<0){c.valid=false;c.quantite.valid=false;var a=new VRerreur();a.code=ERR_215_CODE;a.message=ERR_215_MSG;c.quantite.erreurs.push(a)}if((isNaN(b.prix)||b.prix==0)&&(!isNaN(b.quantite)&&b.quantite!=0)){c.valid=false;c.prix.valid=false;var a=new VRerreur();a.code=ERR_213_CODE;a.message=ERR_213_MSG;c.prix.erreurs.push(a)}if(b.prix<0){c.valid=false;c.prix.valid=false;var a=new VRerreur();a.code=ERR_215_CODE;a.message=ERR_215_MSG;c.prix.erreurs.push(a)}return c};this.validDelete=function(b){var c=new ProduitAchatVR();if(isNaN(parseInt(b.id))){c.valid=false;c.id.valid=false;var a=new VRerreur();a.code=ERR_104_CODE;a.message=ERR_104_MSG;c.id.erreurs.push(a)}return c};this.validUpdate=function(b){var d=this.validDelete(b);if(d.valid){var c=new ProduitAchatVR();if(isNaN(parseInt(b.id))){c.valid=false;c.log.valid=false;var a=new VRerreur();a.code=ERR_104_CODE;a.message=ERR_104_MSG;c.log.erreurs.push(a)}if(!b.quantite.checkLength(0,12)){c.valid=false;c.quantite.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.quantite.erreurs.push(a)}if(b.quantite!=""&&!b.quantite.isFloat()){c.valid=false;c.quantite.valid=false;var a=new VRerreur();a.code=ERR_109_CODE;a.message=ERR_109_MSG;c.quantite.erreurs.push(a)}if(!b.prix.checkLength(0,12)){c.valid=false;c.prix.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.prix.erreurs.push(a)}if(b.prix!=""&&!b.prix.isFloat()){c.valid=false;c.prix.valid=false;var a=new VRerreur();a.code=ERR_109_CODE;a.message=ERR_109_MSG;c.prix.erreurs.push(a)}if((isNaN(b.quantite)||b.quantite==0)&&(!isNaN(b.prix)&&b.prix!=0)){c.valid=false;c.quantite.valid=false;var a=new VRerreur();a.code=ERR_214_CODE;a.message=ERR_214_MSG;c.quantite.erreurs.push(a)}if(b.quantite<0){c.valid=false;c.quantite.valid=false;var a=new VRerreur();a.code=ERR_215_CODE;a.message=ERR_215_MSG;c.quantite.erreurs.push(a)}if((isNaN(b.prix)||b.prix==0)&&(!isNaN(b.quantite)&&b.quantite!=0)){c.valid=false;c.prix.valid=false;var a=new VRerreur();a.code=ERR_213_CODE;a.message=ERR_213_MSG;c.prix.erreurs.push(a)}if(b.prix<0){c.valid=false;c.prix.valid=false;var a=new VRerreur();a.code=ERR_215_CODE;a.message=ERR_215_MSG;c.prix.erreurs.push(a)}return c}return d}}function AchatCommandeValid(){this.validAjout=function(g){var h=new AchatCommandeVR();if(isNaN(parseInt(g.id))){h.valid=false;h.log.valid=false;var c=new VRerreur();c.code=ERR_104_CODE;c.message=ERR_104_MSG;h.log.erreurs.push(c)}if(!g.idCompte.checkLength(0,11)){h.valid=false;h.log.valid=false;var c=new VRerreur();c.code=ERR_101_CODE;c.message=ERR_101_MSG;h.log.erreurs.push(c)}if(!g.idCompte.isInt()){h.valid=false;h.log.valid=false;var c=new VRerreur();c.code=ERR_108_CODE;c.message=ERR_108_MSG;h.log.erreurs.push(c)}if(g.idCompte.isEmpty()){h.valid=false;h.log.valid=false;var c=new VRerreur();c.code=ERR_201_CODE;c.message=ERR_201_MSG;h.log.erreurs.push(c)}if(isArray(g.produits)){if(g.produits.length>0){var b=new ProduitAchatValid();var f=0;var e=0;while(g.produits[f]){var d=b.validAjout(g.produits[f]);if(!d.valid){h.valid=false}if(!g.produits[f].id.isEmpty()){h.produits[g.produits[f].id]=d}else{h.produits.push(d)}if(!isNaN(g.produits[f].quantite)&&g.produits[f].quantite!=0){e++}f++}if(e==0){h.valid=false;h.log.valid=false;var c=new VRerreur();c.code=ERR_207_CODE;c.message=ERR_207_MSG;h.log.erreurs.push(c)}}else{h.valid=false;h.log.valid=false;var c=new VRerreur();c.code=ERR_207_CODE;c.message=ERR_207_MSG;h.log.erreurs.push(c)}}else{h.valid=false;h.log.valid=false;var c=new VRerreur();c.code=ERR_111_CODE;c.message=ERR_111_MSG;h.log.erreurs.push(c)}if(!g.rechargement.montant.isEmpty()&&g.rechargement.montant!=0){var a=new RechargementCompteValid();h.rechargement=a.validAjout(g.rechargement);if(!h.rechargement.valid){h.valid=false}}return h};this.validDelete=function(b){var c=new AchatCommandeVR();if(isNaN(parseInt(b.id))){c.valid=false;c.id.valid=false;var a=new VRerreur();a.code=ERR_104_CODE;a.message=ERR_104_MSG;c.id.erreurs.push(a)}return c};this.validUpdate=function(f){var h=this.validDelete(f);if(h.valid){var g=new AchatCommandeVR();if(isNaN(parseInt(f.id))){g.valid=false;g.log.valid=false;var c=new VRerreur();c.code=ERR_104_CODE;c.message=ERR_104_MSG;g.log.erreurs.push(c)}if(!f.idCompte.checkLength(0,11)){g.valid=false;g.idCompte.valid=false;var c=new VRerreur();c.code=ERR_101_CODE;c.message=ERR_101_MSG;g.idCompte.erreurs.push(c)}if(!f.idCompte.isInt()){g.valid=false;g.idCompte.valid=false;var c=new VRerreur();c.code=ERR_108_CODE;c.message=ERR_108_MSG;g.idCompte.erreurs.push(c)}if(f.idCompte.isEmpty()){g.valid=false;g.idCompte.valid=false;var c=new VRerreur();c.code=ERR_201_CODE;c.message=ERR_201_MSG;g.idCompte.erreurs.push(c)}if(isArray(f.produits)){if(f.produits.length>0){var b=new ProduitAchatValid();var e=0;while(f.produits[e]){var d=b.validAjout(f.produits[e]);if(!d.valid){g.valid=false}if(!f.produits[e].id.isEmpty()){g.produits[f.produits[e].id]=d}else{g.produits.push(d)}e++}}else{g.valid=false;g.log.valid=false;var c=new VRerreur();c.code=ERR_207_CODE;c.message=ERR_207_MSG;g.log.erreurs.push(c)}}else{g.valid=false;g.log.valid=false;var c=new VRerreur();c.code=ERR_111_CODE;c.message=ERR_111_MSG;g.log.erreurs.push(c)}if(!isNaN(f.rechargement.montant)&&f.rechargement.montant!=0){var a=new RechargementCompteValid();g.rechargement=a.validAjout(f.rechargement);if(!g.rechargement.valid){g.valid=false}}return g}return h}}function DetailCommandeValid(){this.validAjout=function(b){var c=new DetailCommandeVR();if(!b.idProduit.checkLength(0,11)){c.valid=false;c.idProduit.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.idProduit.erreurs.push(a)}if(b.idProduit!=""&&!b.idProduit.isInt()){c.valid=false;c.idProduit.valid=false;var a=new VRerreur();a.code=ERR_108_CODE;a.message=ERR_108_MSG;c.idProduit.erreurs.push(a)}if(!b.taille.checkLength(0,12)){c.valid=false;c.taille.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.taille.erreurs.push(a)}if(!b.taille.isInt()){c.valid=false;c.taille.valid=false;var a=new VRerreur();a.code=ERR_108_CODE;a.message=ERR_108_MSG;c.taille.erreurs.push(a)}if(!b.prix.checkLength(0,12)){c.valid=false;c.prix.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.prix.erreurs.push(a)}if(!b.prix.isFloat()){c.valid=false;c.prix.valid=false;var a=new VRerreur();a.code=ERR_109_CODE;a.message=ERR_109_MSG;c.prix.erreurs.push(a)}if(b.taille.isEmpty()){c.valid=false;c.taille.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.taille.erreurs.push(a)}if(b.prix.isEmpty()){c.valid=false;c.prix.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.prix.erreurs.push(a)}return c};this.validDelete=function(b){var c=new DetailCommandeVR();if(isNaN(parseInt(b.id))){c.valid=false;c.id.valid=false;var a=new VRerreur();a.code=ERR_104_CODE;a.message=ERR_104_MSG;c.id.erreurs.push(a)}return c};this.validUpdate=function(b){var d=this.validDelete(b);if(d.valid){var c=new DetailCommandeVR();if(!b.idProduit.checkLength(0,11)){c.valid=false;c.idProduit.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.idProduit.erreurs.push(a)}if(!b.idProduit.isInt()){c.valid=false;c.idProduit.valid=false;var a=new VRerreur();a.code=ERR_108_CODE;a.message=ERR_108_MSG;c.idProduit.erreurs.push(a)}if(!b.taille.checkLength(0,12)){c.valid=false;c.taille.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.taille.erreurs.push(a)}if(!b.taille.isInt()){c.valid=false;c.taille.valid=false;var a=new VRerreur();a.code=ERR_108_CODE;a.message=ERR_108_MSG;c.taille.erreurs.push(a)}if(!b.prix.checkLength(0,12)){c.valid=false;c.prix.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.prix.erreurs.push(a)}if(!b.prix.isFloat()){c.valid=false;c.prix.valid=false;var a=new VRerreur();a.code=ERR_109_CODE;a.message=ERR_109_MSG;c.prix.erreurs.push(a)}if(b.idProduit.isEmpty()){c.valid=false;c.idProduit.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.idProduit.erreurs.push(a)}if(b.taille.isEmpty()){c.valid=false;c.taille.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.taille.erreurs.push(a)}if(b.prix.isEmpty()){c.valid=false;c.prix.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.prix.erreurs.push(a)}return c}return d}}function RechargementCompteValid(){this.validAjout=function(b){var c=new RechargementCompteVR();if(isNaN(parseInt(b.id))){c.valid=false;c.log.valid=false;var a=new VRerreur();a.code=ERR_104_CODE;a.message=ERR_104_MSG;c.log.erreurs.push(a)}if(!b.montant.checkLength(0,12)){c.valid=false;c.montant.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.montant.erreurs.push(a)}if(!b.montant.isFloat()){c.valid=false;c.montant.valid=false;var a=new VRerreur();a.code=ERR_109_CODE;a.message=ERR_109_MSG;c.montant.erreurs.push(a)}if(!b.typePaiement.checkLength(0,11)){c.valid=false;c.typePaiement.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.typePaiement.erreurs.push(a)}if(!b.typePaiement.isInt()){c.valid=false;c.typePaiement.valid=false;var a=new VRerreur();a.code=ERR_108_CODE;a.message=ERR_108_MSG;c.typePaiement.erreurs.push(a)}if(!b.champComplementaireObligatoire.checkLength(0,1)){c.valid=false;c.champComplementaireObligatoire.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.champComplementaireObligatoire.erreurs.push(a)}if(!b.champComplementaireObligatoire.isInt()){c.valid=false;c.champComplementaireObligatoire.valid=false;var a=new VRerreur();a.code=ERR_108_CODE;a.message=ERR_108_MSG;c.champComplementaireObligatoire.erreurs.push(a)}if(b.champComplementaire!=""&&!b.champComplementaire.checkLength(0,50)){c.valid=false;c.champComplementaire.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.champComplementaire.erreurs.push(a)}if(b.montant.isEmpty()){c.valid=false;c.montant.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.montant.erreurs.push(a)}if(b.montant<0){c.valid=false;c.montant.valid=false;var a=new VRerreur();a.code=ERR_215_CODE;a.message=ERR_215_MSG;c.montant.erreurs.push(a)}if(b.typePaiement.isEmpty()){c.valid=false;c.log.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.log.erreurs.push(a)}if(b.champComplementaireObligatoire.isEmpty()){c.valid=false;c.champComplementaireObligatoire.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.champComplementaireObligatoire.erreurs.push(a)}if(b.champComplementaireObligatoire==1&&b.champComplementaire.isEmpty()){c.valid=false;c.champComplementaire.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.champComplementaire.erreurs.push(a)}return c};this.validDelete=function(b){var c=new RechargementCompteVR();if(isNaN(parseInt(b.id))){c.valid=false;c.id.valid=false;var a=new VRerreur();a.code=ERR_104_CODE;a.message=ERR_104_MSG;c.id.erreurs.push(a)}return c};this.validUpdate=function(b){var d=this.validDelete(b);if(d.valid){var c=new RechargementCompteVR();if(isNaN(parseInt(b.id))){c.valid=false;c.log.valid=false;var a=new VRerreur();a.code=ERR_104_CODE;a.message=ERR_104_MSG;c.log.erreurs.push(a)}if(!b.montant.checkLength(0,12)){c.valid=false;c.montant.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.montant.erreurs.push(a)}if(!b.montant.isFloat()){c.valid=false;c.montant.valid=false;var a=new VRerreur();a.code=ERR_109_CODE;a.message=ERR_109_MSG;c.montant.erreurs.push(a)}if(!b.typePaiement.checkLength(0,11)){c.valid=false;c.typePaiement.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.typePaiement.erreurs.push(a)}if(!b.typePaiement.isInt()){c.valid=false;c.typePaiement.valid=false;var a=new VRerreur();a.code=ERR_108_CODE;a.message=ERR_108_MSG;c.typePaiement.erreurs.push(a)}if(!b.champComplementaireObligatoire.checkLength(0,1)){c.valid=false;c.champComplementaireObligatoire.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.champComplementaireObligatoire.erreurs.push(a)}if(!b.champComplementaireObligatoire.isInt()){c.valid=false;c.champComplementaireObligatoire.valid=false;var a=new VRerreur();a.code=ERR_108_CODE;a.message=ERR_108_MSG;c.champComplementaireObligatoire.erreurs.push(a)}if(b.champComplementaire!=""&&!b.champComplementaire.checkLength(0,50)){c.valid=false;c.champComplementaire.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.champComplementaire.erreurs.push(a)}if(b.montant.isEmpty()){c.valid=false;c.montant.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.montant.erreurs.push(a)}if(b.montant<0){c.valid=false;c.montant.valid=false;var a=new VRerreur();a.code=ERR_215_CODE;a.message=ERR_215_MSG;c.montant.erreurs.push(a)}if(b.typePaiement.isEmpty()){c.valid=false;c.log.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.log.erreurs.push(a)}if(b.champComplementaireObligatoire.isEmpty()){c.valid=false;c.champComplementaireObligatoire.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.champComplementaireObligatoire.erreurs.push(a)}if(b.champComplementaireObligatoire==1&&b.champComplementaire.isEmpty()){c.valid=false;c.champComplementaire.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.champComplementaire.erreurs.push(a)}return c}return d}}function ReservationCommandeValid(){this.validAjout=function(b){var c=new ReservationCommandeVR();if(!b.stoQuantite.checkLength(0,12)){c.valid=false;c.stoQuantite.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.stoQuantite.erreurs.push(a)}if(!b.stoQuantite.isFloat()){c.valid=false;c.stoQuantite.valid=false;var a=new VRerreur();a.code=ERR_108_CODE;a.message=ERR_108_MSG;c.stoQuantite.erreurs.push(a)}if(!b.stoIdProduit.checkLength(0,11)){c.valid=false;c.stoIdProduit.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.stoIdProduit.erreurs.push(a)}if(!b.stoIdProduit.isFloat()){c.valid=false;c.stoIdProduit.valid=false;var a=new VRerreur();a.code=ERR_108_CODE;a.message=ERR_108_MSG;c.stoIdProduit.erreurs.push(a)}if(b.stoQuantite.isEmpty()){c.valid=false;c.stoQuantite.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.stoQuantite.erreurs.push(a)}if(b.stoIdProduit.isEmpty()){c.valid=false;c.stoIdProduit.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.stoIdProduit.erreurs.push(a)}return c};this.validDelete=function(b){var c=new ReservationCommandeVR();if(isNaN(parseInt(b.id))){c.valid=false;c.id.valid=false;var a=new VRerreur();a.code=ERR_104_CODE;a.message=ERR_104_MSG;c.id.erreurs.push(a)}return c};this.validUpdate=function(b){var d=this.validDelete(b);if(d.valid){var c=new ReservationCommandeVR();if(!b.stoQuantite.checkLength(0,12)){c.valid=false;c.stoQuantite.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.stoQuantite.erreurs.push(a)}if(!b.stoQuantite.isFloat()){c.valid=false;c.stoQuantite.valid=false;var a=new VRerreur();a.code=ERR_108_CODE;a.message=ERR_108_MSG;c.stoQuantite.erreurs.push(a)}if(!b.stoIdProduit.checkLength(0,11)){c.valid=false;c.stoIdProduit.valid=false;var a=new VRerreur();a.code=ERR_101_CODE;a.message=ERR_101_MSG;c.stoIdProduit.erreurs.push(a)}if(!b.stoIdProduit.isFloat()){c.valid=false;c.stoIdProduit.valid=false;var a=new VRerreur();a.code=ERR_108_CODE;a.message=ERR_108_MSG;c.stoIdProduit.erreurs.push(a)}if(b.stoQuantite.isEmpty()){c.valid=false;c.stoQuantite.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.stoQuantite.erreurs.push(a)}if(b.stoIdProduit.isEmpty()){c.valid=false;c.stoIdProduit.valid=false;var a=new VRerreur();a.code=ERR_201_CODE;a.message=ERR_201_MSG;c.stoIdProduit.erreurs.push(a)}return c}return d}}function CommandeCompleteValid(){this.validAjout=function(e){var f=new CommandeCompleteVR();if(!e.numero.checkLength(0,11)){f.valid=false;f.numero.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;f.numero.erreurs.push(b)}if(!e.nom.checkLength(0,100)){f.valid=false;f.nom.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;f.nom.erreurs.push(b)}if(!e.dateMarcheDebut.checkDate("db")){f.valid=false;f.dateMarcheDebut.valid=false;var b=new VRerreur();b.code=ERR_103_CODE;b.message=ERR_103_MSG;f.dateMarcheDebut.erreurs.push(b)}if(!e.dateMarcheDebut.checkDateExist("db")){f.valid=false;f.dateMarcheDebut.valid=false;var b=new VRerreur();b.code=ERR_105_CODE;b.message=ERR_105_MSG;f.dateMarcheDebut.erreurs.push(b)}if(!e.timeMarcheDebut.checkTime()){f.valid=false;f.timeMarcheDebut.valid=false;var b=new VRerreur();b.code=ERR_106_CODE;b.message=ERR_106_MSG;f.timeMarcheDebut.erreurs.push(b)}if(!e.timeMarcheDebut.checkTimeExist()){f.valid=false;f.timeMarcheDebut.valid=false;var b=new VRerreur();b.code=ERR_107_CODE;b.message=ERR_107_MSG;f.timeMarcheDebut.erreurs.push(b)}if(!e.dateMarcheFin.checkDate("db")){f.valid=false;f.dateMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_103_CODE;b.message=ERR_103_MSG;f.dateMarcheFin.erreurs.push(b)}if(!e.dateMarcheFin.checkDateExist("db")){f.valid=false;f.dateMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_105_CODE;b.message=ERR_105_MSG;f.dateMarcheFin.erreurs.push(b)}if(!e.timeMarcheFin.checkTime()){f.valid=false;f.timeMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_106_CODE;b.message=ERR_106_MSG;f.timeMarcheFin.erreurs.push(b)}if(!e.timeMarcheFin.checkTimeExist()){f.valid=false;f.timeMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_107_CODE;b.message=ERR_107_MSG;f.timeMarcheFin.erreurs.push(b)}if(!e.dateFinReservation.checkDate("db")){f.valid=false;f.dateFinReservation.valid=false;var b=new VRerreur();b.code=ERR_103_CODE;b.message=ERR_103_MSG;f.dateFinReservation.erreurs.push(b)}if(!e.dateFinReservation.checkDateExist("db")){f.valid=false;f.dateFinReservation.valid=false;var b=new VRerreur();b.code=ERR_105_CODE;b.message=ERR_105_MSG;f.dateFinReservation.erreurs.push(b)}if(!e.timeFinReservation.checkTime()){f.valid=false;f.timeFinReservation.valid=false;var b=new VRerreur();b.code=ERR_106_CODE;b.message=ERR_106_MSG;f.timeFinReservation.erreurs.push(b)}if(!e.timeFinReservation.checkTimeExist()){f.valid=false;f.timeFinReservation.valid=false;var b=new VRerreur();b.code=ERR_107_CODE;b.message=ERR_107_MSG;f.timeFinReservation.erreurs.push(b)}if(!e.archive.checkLength(0,1)){f.valid=false;f.archive.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;f.archive.erreurs.push(b)}if(e.dateMarcheDebut.isEmpty()){f.valid=false;f.dateMarcheDebut.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.dateMarcheDebut.erreurs.push(b)}if(e.timeMarcheDebut.isEmpty()){f.valid=false;f.timeMarcheDebut.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.timeMarcheDebut.erreurs.push(b)}if(e.dateMarcheFin.isEmpty()){f.valid=false;f.dateMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.dateMarcheFin.erreurs.push(b)}if(e.timeMarcheFin.isEmpty()){f.valid=false;f.timeMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.timeMarcheFin.erreurs.push(b)}if(e.dateFinReservation.isEmpty()){f.valid=false;f.dateFinReservation.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.dateFinReservation.erreurs.push(b)}if(e.timeFinReservation.isEmpty()){f.valid=false;f.timeFinReservation.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.timeFinReservation.erreurs.push(b)}if(e.archive.isEmpty()){f.valid=false;f.archive.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.archive.erreurs.push(b)}if(!dateTimeEstPLusGrandeEgale(e.dateMarcheDebut+" "+e.timeMarcheDebut,e.dateFinReservation+" "+e.timeFinReservation,"db")){if(!dateEstPLusGrandeEgale(e.dateMarcheDebut,e.dateFinReservation,"db")){f.valid=false;f.dateMarcheDebut.valid=false;f.dateFinReservation.valid=false;var b=new VRerreur();b.code=ERR_202_CODE;b.message=ERR_202_MSG;f.dateMarcheDebut.erreurs.push(b);f.dateFinReservation.erreurs.push(b)}else{if(timeEstPLusGrandeEgale(e.timeFinReservation,e.timeMarcheDebut)){f.valid=false;f.timeMarcheDebut.valid=false;f.timeFinReservation.valid=false;var b=new VRerreur();b.code=ERR_203_CODE;b.message=ERR_203_MSG;f.timeMarcheDebut.erreurs.push(b);f.timeFinReservation.erreurs.push(b)}}}if(timeEstPLusGrandeEgale(e.timeMarcheDebut,e.timeMarcheFin)){f.valid=false;f.timeMarcheDebut.valid=false;f.timeMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_204_CODE;b.message=ERR_204_MSG;f.timeMarcheDebut.erreurs.push(b);f.timeMarcheFin.erreurs.push(b)}if(!dateEstPLusGrandeEgale(e.dateMarcheDebut,getDateAujourdhuiDb(),"db")){f.valid=false;f.dateMarcheDebut.valid=false;var b=new VRerreur();b.code=ERR_209_CODE;b.message=ERR_209_MSG;f.dateMarcheDebut.erreurs.push(b)}if(!dateEstPLusGrandeEgale(e.dateMarcheFin,getDateAujourdhuiDb(),"db")){f.valid=false;f.dateMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_209_CODE;b.message=ERR_209_MSG;f.dateMarcheFin.erreurs.push(b)}if(!dateEstPLusGrandeEgale(e.dateFinReservation,getDateAujourdhuiDb(),"db")){f.valid=false;f.dateFinReservation.valid=false;var b=new VRerreur();b.code=ERR_209_CODE;b.message=ERR_209_MSG;f.dateFinReservation.erreurs.push(b)}if(isArray(e.produits)){if(e.produits.length>0){var a=new ProduitCommandeValid();var d=0;while(e.produits[d]){var c=a.validAjout(e.produits[d]);if(!c.valid){f.valid=false}f.produits.push(c);d++}}else{f.valid=false;f.log.valid=false;var b=new VRerreur();b.code=ERR_207_CODE;b.message=ERR_207_MSG;f.log.erreurs.push(b)}}else{f.valid=false;f.log.valid=false;var b=new VRerreur();b.code=ERR_111_CODE;b.message=ERR_111_MSG;f.log.erreurs.push(b)}return f};this.validDelete=function(b){var c=new CommandeCompleteVR();if(isNaN(parseInt(b.id))){c.valid=false;c.id.valid=false;var a=new VRerreur();a.code=ERR_104_CODE;a.message=ERR_104_MSG;c.id.erreurs.push(a)}return c};this.validUpdate=function(e){var g=this.validDelete(e);if(g.valid){var f=new CommandeCompleteVR();if(!e.numero.checkLength(0,11)){f.valid=false;f.numero.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;f.numero.erreurs.push(b)}if(!e.nom.checkLength(0,100)){f.valid=false;f.nom.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;f.nom.erreurs.push(b)}if(!e.dateMarcheDebut.checkDate("db")){f.valid=false;f.dateMarcheDebut.valid=false;var b=new VRerreur();b.code=ERR_103_CODE;b.message=ERR_103_MSG;f.dateMarcheDebut.erreurs.push(b)}if(!e.dateMarcheDebut.checkDateExist("db")){f.valid=false;f.dateMarcheDebut.valid=false;var b=new VRerreur();b.code=ERR_105_CODE;b.message=ERR_105_MSG;f.dateMarcheDebut.erreurs.push(b)}if(!e.timeMarcheDebut.checkTime()){f.valid=false;f.timeMarcheDebut.valid=false;var b=new VRerreur();b.code=ERR_106_CODE;b.message=ERR_106_MSG;f.timeMarcheDebut.erreurs.push(b)}if(!e.timeMarcheDebut.checkTimeExist()){f.valid=false;f.timeMarcheDebut.valid=false;var b=new VRerreur();b.code=ERR_107_CODE;b.message=ERR_107_MSG;f.timeMarcheDebut.erreurs.push(b)}if(!e.dateMarcheFin.checkDate("db")){f.valid=false;f.dateMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_103_CODE;b.message=ERR_103_MSG;f.dateMarcheFin.erreurs.push(b)}if(!e.dateMarcheFin.checkDateExist("db")){f.valid=false;f.dateMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_105_CODE;b.message=ERR_105_MSG;f.dateMarcheFin.erreurs.push(b)}if(!e.timeMarcheFin.checkTime()){f.valid=false;f.timeMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_106_CODE;b.message=ERR_106_MSG;f.timeMarcheFin.erreurs.push(b)}if(!e.timeMarcheFin.checkTimeExist()){f.valid=false;f.timeMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_107_CODE;b.message=ERR_107_MSG;f.timeMarcheFin.erreurs.push(b)}if(!e.dateFinReservation.checkDate("db")){f.valid=false;f.dateFinReservation.valid=false;var b=new VRerreur();b.code=ERR_103_CODE;b.message=ERR_103_MSG;f.dateFinReservation.erreurs.push(b)}if(!e.dateFinReservation.checkDateExist("db")){f.valid=false;f.dateFinReservation.valid=false;var b=new VRerreur();b.code=ERR_105_CODE;b.message=ERR_105_MSG;f.dateFinReservation.erreurs.push(b)}if(!e.timeFinReservation.checkTime()){f.valid=false;f.timeFinReservation.valid=false;var b=new VRerreur();b.code=ERR_106_CODE;b.message=ERR_106_MSG;f.timeFinReservation.erreurs.push(b)}if(!e.timeFinReservation.checkTimeExist()){f.valid=false;f.timeFinReservation.valid=false;var b=new VRerreur();b.code=ERR_107_CODE;b.message=ERR_107_MSG;f.timeFinReservation.erreurs.push(b)}if(!e.archive.checkLength(0,1)){f.valid=false;f.archive.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;f.archive.erreurs.push(b)}if(e.dateMarcheDebut.isEmpty()){f.valid=false;f.dateMarcheDebut.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.dateMarcheDebut.erreurs.push(b)}if(e.timeMarcheDebut.isEmpty()){f.valid=false;f.timeMarcheDebut.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.timeMarcheDebut.erreurs.push(b)}if(e.dateMarcheFin.isEmpty()){f.valid=false;f.dateMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.dateMarcheFin.erreurs.push(b)}if(e.timeMarcheFin.isEmpty()){f.valid=false;f.timeMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.timeMarcheFin.erreurs.push(b)}if(e.dateFinReservation.isEmpty()){f.valid=false;f.dateFinReservation.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.dateFinReservation.erreurs.push(b)}if(e.timeFinReservation.isEmpty()){f.valid=false;f.timeFinReservation.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.timeFinReservation.erreurs.push(b)}if(e.archive.isEmpty()){f.valid=false;f.archive.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.archive.erreurs.push(b)}if(!dateTimeEstPLusGrandeEgale(e.dateMarcheDebut+" "+e.timeMarcheDebut,e.dateFinReservation+" "+e.timeFinReservation,"db")){if(!dateEstPLusGrandeEgale(e.dateMarcheDebut,e.dateFinReservation,"db")){f.valid=false;f.dateMarcheDebut.valid=false;f.dateFinReservation.valid=false;var b=new VRerreur();b.code=ERR_202_CODE;b.message=ERR_202_MSG;f.dateMarcheDebut.erreurs.push(b);f.dateFinReservation.erreurs.push(b)}else{if(timeEstPLusGrandeEgale(e.timeFinReservation,e.timeMarcheDebut)){f.valid=false;f.timeMarcheDebut.valid=false;f.timeFinReservation.valid=false;var b=new VRerreur();b.code=ERR_203_CODE;b.message=ERR_203_MSG;f.timeMarcheDebut.erreurs.push(b);f.timeFinReservation.erreurs.push(b)}}}if(timeEstPLusGrandeEgale(e.timeMarcheDebut,e.timeMarcheFin)){f.valid=false;f.timeMarcheDebut.valid=false;f.timeMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_204_CODE;b.message=ERR_204_MSG;f.timeMarcheDebut.erreurs.push(b);f.timeMarcheFin.erreurs.push(b)}if(!dateEstPLusGrandeEgale(e.dateMarcheDebut,getDateAujourdhuiDb(),"db")){f.valid=false;f.dateMarcheDebut.valid=false;var b=new VRerreur();b.code=ERR_209_CODE;b.message=ERR_209_MSG;f.dateMarcheDebut.erreurs.push(b)}if(!dateEstPLusGrandeEgale(e.dateMarcheFin,getDateAujourdhuiDb(),"db")){f.valid=false;f.dateMarcheFin.valid=false;var b=new VRerreur();b.code=ERR_209_CODE;b.message=ERR_209_MSG;f.dateMarcheFin.erreurs.push(b)}if(!dateEstPLusGrandeEgale(e.dateFinReservation,getDateAujourdhuiDb(),"db")){f.valid=false;f.dateFinReservation.valid=false;var b=new VRerreur();b.code=ERR_209_CODE;b.message=ERR_209_MSG;f.dateFinReservation.erreurs.push(b)}if(isArray(e.produits)){if(e.produits.length>0){var a=new ProduitCommandeValid();var d=0;while(e.produits[d]){var c=a.validAjout(e.produits[d]);if(!c.valid){f.valid=false}f.produits.push(c);d++}}else{f.valid=false;f.log.valid=false;var b=new VRerreur();b.code=ERR_207_CODE;b.message=ERR_207_MSG;f.log.erreurs.push(b)}}else{f.valid=false;f.log.valid=false;var b=new VRerreur();b.code=ERR_111_CODE;b.message=ERR_111_MSG;f.log.erreurs.push(b)}return f}return g}}function ProduitCommandeValid(){this.validAjout=function(d,f){var g=new ProduitCommandeVR();if(!d.idNom.checkLength(0,11)){g.valid=false;g.idNom.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;g.idNom.erreurs.push(b)}if(!d.idNom.isInt()){g.valid=false;g.idNom.valid=false;var b=new VRerreur();b.code=ERR_108_CODE;b.message=ERR_108_MSG;g.idNom.erreurs.push(b)}if(!d.nom.checkLength(0,50)){g.valid=false;g.nom.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;g.nom.erreurs.push(b)}if(!d.idCategorie.checkLength(0,11)){g.valid=false;g.idCategorie.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;g.idCategorie.erreurs.push(b)}if(d.idCategorie!=""&&!d.idCategorie.isInt()){g.valid=false;g.idCategorie.valid=false;var b=new VRerreur();b.code=ERR_108_CODE;b.message=ERR_108_MSG;g.idCategorie.erreurs.push(b)}if(!d.categorie.checkLength(0,50)){g.valid=false;g.categorie.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;g.categorie.erreurs.push(b)}if(!d.unite.checkLength(0,20)){g.valid=false;g.unite.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;g.unite.erreurs.push(b)}if(!d.qteMaxCommande.checkLength(0,12)){g.valid=false;g.qteMaxCommande.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;g.qteMaxCommande.erreurs.push(b)}if(!d.qteMaxCommande.isFloat()){g.valid=false;g.qteMaxCommande.valid=false;var b=new VRerreur();b.code=ERR_109_CODE;b.message=ERR_109_MSG;g.qteMaxCommande.erreurs.push(b)}if(!d.qteRestante.checkLength(0,12)){g.valid=false;g.qteRestante.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;g.qteRestante.erreurs.push(b)}if(!d.qteRestante.isFloat()){g.valid=false;g.qteRestante.valid=false;var b=new VRerreur();b.code=ERR_109_CODE;b.message=ERR_109_MSG;g.qteRestante.erreurs.push(b)}if(d.idNom.isEmpty()){g.valid=false;g.idNom.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;g.idNom.erreurs.push(b)}if(d.unite.isEmpty()){g.valid=false;g.unite.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;g.unite.erreurs.push(b)}if(d.qteMaxCommande.isEmpty()){g.valid=false;g.qteMaxCommande.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;g.qteMaxCommande.erreurs.push(b)}if(d.qteRestante.isEmpty()){g.valid=false;g.qteRestante.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;g.qteRestante.erreurs.push(b)}if(parseFloat(d.qteMaxCommande)>parseFloat(d.qteRestante)){g.valid=false;g.qteRestante.valid=false;g.qteMaxCommande.valid=false;var b=new VRerreur();b.code=ERR_205_CODE;b.message=ERR_205_MSG;g.qteRestante.erreurs.push(b);g.qteMaxCommande.erreurs.push(b)}if(f!="simple"){if(isArray(d.lots)){var e=new DetailCommandeValid();var c=0;while(d.lots[c]){var a=e.validAjout(d.lots[c]);if(!a.valid){g.valid=false}if(parseFloat(d.lots[c].taille)>parseFloat(d.qteMaxCommande)){g.valid=false;a.valid=false;a.taille.valid=false;var b=new VRerreur();b.code=ERR_206_CODE;b.message=ERR_206_MSG;a.taille.erreurs.push(b)}g.lots.push(a);c++}}else{g.valid=false;g.log.valid=false;var b=new VRerreur();b.code=ERR_110_CODE;b.message=ERR_110_MSG;g.log.erreurs.push(b)}}return g};this.validDelete=function(b){var c=new ProduitCommandeVR();if(isNaN(parseInt(b.id))){c.valid=false;c.id.valid=false;var a=new VRerreur();a.code=ERR_104_CODE;a.message=ERR_104_MSG;c.id.erreurs.push(a)}return c};this.validUpdate=function(d){var g=this.validDelete(d);if(g.valid){var f=new ProduitCommandeVR();if(!d.idNom.checkLength(0,11)){f.valid=false;f.idNom.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;f.idNom.erreurs.push(b)}if(!d.idNom.isInt()){f.valid=false;f.idNom.valid=false;var b=new VRerreur();b.code=ERR_108_CODE;b.message=ERR_108_MSG;f.idNom.erreurs.push(b)}if(!d.nom.checkLength(0,50)){f.valid=false;f.nom.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;f.nom.erreurs.push(b)}if(!d.idCategorie.checkLength(0,11)){f.valid=false;f.idCategorie.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;f.idCategorie.erreurs.push(b)}if(d.idCategorie!=""&&!d.idCategorie.isInt()){f.valid=false;f.idCategorie.valid=false;var b=new VRerreur();b.code=ERR_108_CODE;b.message=ERR_108_MSG;f.idCategorie.erreurs.push(b)}if(!d.categorie.checkLength(0,50)){f.valid=false;f.categorie.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;f.categorie.erreurs.push(b)}if(!d.unite.checkLength(0,20)){f.valid=false;f.unite.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;f.unite.erreurs.push(b)}if(!d.qteMaxCommande.checkLength(0,12)){f.valid=false;f.qteMaxCommande.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;f.qteMaxCommande.erreurs.push(b)}if(!d.qteMaxCommande.isFloat()){f.valid=false;f.qteMaxCommande.valid=false;var b=new VRerreur();b.code=ERR_109_CODE;b.message=ERR_109_MSG;f.qteMaxCommande.erreurs.push(b)}if(!d.qteRestante.checkLength(0,12)){f.valid=false;f.qteRestante.valid=false;var b=new VRerreur();b.code=ERR_101_CODE;b.message=ERR_101_MSG;f.qteRestante.erreurs.push(b)}if(!d.qteRestante.isFloat()){f.valid=false;f.qteRestante.valid=false;var b=new VRerreur();b.code=ERR_109_CODE;b.message=ERR_109_MSG;f.qteRestante.erreurs.push(b)}if(d.idNom.isEmpty()){f.valid=false;f.idNom.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.idNom.erreurs.push(b)}if(d.unite.isEmpty()){f.valid=false;f.unite.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.unite.erreurs.push(b)}if(d.qteMaxCommande.isEmpty()){f.valid=false;f.qteMaxCommande.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.qteMaxCommande.erreurs.push(b)}if(d.qteRestante.isEmpty()){f.valid=false;f.qteRestante.valid=false;var b=new VRerreur();b.code=ERR_201_CODE;b.message=ERR_201_MSG;f.qteRestante.erreurs.push(b)}if(parseFloat(d.qteMaxCommande)>parseFloat(d.qteRestante)){f.valid=false;f.qteRestante.valid=false;f.qteMaxCommande.valid=false;var b=new VRerreur();b.code=ERR_205_CODE;b.message=ERR_205_MSG;f.qteRestante.erreurs.push(b);f.qteMaxCommande.erreurs.push(b)}if(isArray(d.lots)){var e=new DetailCommandeValid();var c=0;while(d.lots[c]){var a=e.validAjout(d.lots[c]);if(!a.valid){f.valid=false}if(parseFloat(d.lots[c].taille)>parseFloat(d.qteMaxCommande)){f.valid=false;a.valid=false;a.taille.valid=false;var b=new VRerreur();b.code=ERR_206_CODE;b.message=ERR_206_MSG;a.taille.erreurs.push(b)}f.lots.push(a);c++}}else{f.valid=false;f.log.valid=false;var b=new VRerreur();b.code=ERR_110_CODE;b.message=ERR_110_MSG;f.log.erreurs.push(b)}return f}return g}}function GestionCommandeTemplate(){this.formulaireAjoutCommande='<div id="contenu"><div id="formulaire_ajout_commande_ext"><div id="dialog-form-creer-nv-pdt" title="Créer un nouveau produit"><form><table><tr><td>Nom</td><td><input type="text" name="nom"/></td></tr><tr><td>Description</td><td><textarea name="description"></textarea></td></tr></table></form></div><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Nouvelle commande</div><div class="com-widget-content"><form id="formulaire-information-creation-commande"><table class="com-table-form"><tr><th class="com-table-form-th ui-widget-content ui-corner-all">Nom de la commande</th><td class="com-table-form-td"><input class="com-input-text ui-widget-content ui-corner-all" type="text" name="nom_commande" id="commande-nom" maxlength="100" /></td></tr><tr><th class="com-table-form-th ui-widget-content ui-corner-all">Fin des commandes *</th><td class="com-table-form-td"><input class="com-input-text ui-widget-content ui-corner-all" type="text" name="date_fin_commande" id="commande-dateFinReservation" /></td><td class="com-table-form-td">&nbsp;&nbsp;à <select name="heure_fin_commande" id="commande-timeFinReservation" ><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option></select>H <select name="minute_fin_commande"><option value="00">00</option><option value="05">05</option><option value="10">10</option><option value="15">15</option><option value="20">20</option><option value="25">25</option><option value="30">30</option><option value="35">35</option><option value="40">40</option><option value="45">45</option><option value="50">50</option><option value="55">55</option></select></td></tr><tr><th class="com-table-form-th ui-widget-content ui-corner-all">Jour du marché *</th><td class="com-table-form-td"><input class="com-input-text ui-widget-content ui-corner-all" type="text" name="date_debut_marche" id="commande-dateMarcheDebut"/></td><td class="com-table-form-td">de <select name="heure_debut_marche" id="commande-timeMarcheDebut"><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option></select>H <select name="minute_debut_marche"><option value="00">00</option><option value="05">05</option><option value="10">10</option><option value="15">15</option><option value="20">20</option><option value="25">25</option><option value="30">30</option><option value="35">35</option><option value="40">40</option><option value="45">45</option><option value="50">50</option><option value="55">55</option></select></td><td class="com-table-form-td">à  <select name="heure_fin_marche" id="commande-timeMarcheFin"><option value="01">01</option><option value="02">02</option><option value="03">03</option><option value="04">04</option><option value="05">05</option><option value="06">06</option><option value="07">07</option><option value="08">08</option><option value="09">09</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option></select>H <select name="minute_fin_marche"><option value="00">00</option><option value="05">05</option><option value="10">10</option><option value="15">15</option><option value="20">20</option><option value="25">25</option><option value="30">30</option><option value="35">35</option><option value="40">40</option><option value="45">45</option><option value="50">50</option><option value="55">55</option></select></td></tr><tr><th class="com-table-form-th ui-widget-content ui-corner-all">Description :</th><td class="com-table-form-td"><textarea class="com-input-text ui-widget-content ui-corner-all" name="description_commande" id="commande-description" ></textarea></td></tr></table></form></div></div><div class="com-widget-window ui-widget ui-widget-content ui-corner-all" id="window-ajout-produit-creation-commande"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Ajouter un produit</div><div class="com-widget-content"><form id="formulaire-ajout-produit-creation-commande"><table class="com-table-form"><tr><th class="com-table-form-th ui-widget-content ui-corner-all" id="ajout-produit-idNom">Produit</th><td class="com-table-form-td" id="ajout-produit-nom"><select name="produit"><!-- BEGIN produits --><option value={produits.id} >{produits.nom}</option><!-- END produits --></select></td><td style="text-align:center;"><button type="button" id="btn-creer-nv-pdt">Créer un nouveau produit</button></td></tr><tr><td class="com-table-form-td"><br/></td></tr><tr><th class="com-table-form-th ui-widget-content ui-corner-all">Stock</th><th class="com-table-form-th ui-widget-content ui-corner-all">Unité</th><th class="com-table-form-th ui-widget-content ui-corner-all">Quantité max par adhérent</th></tr><tr><td class="com-table-form-td"><input class="com-numeric com-input-text ui-widget-content ui-corner-all" type="text" name="stock" maxlength="11" id="ajout-produit-qteRestante"/></td><td class="com-table-form-td"><input class="com-input-text ui-widget-content ui-corner-all" name="unite" type="text" maxlength="20" id="ajout-produit-unite"/></td><td class="com-table-form-td"><input class="com-numeric com-input-text ui-widget-content ui-corner-all" name="qmax" type="text" maxlength="11" id="ajout-produit-qteMaxCommande" /></td></tr><tr><td class="com-table-form-td"><br/></td></tr><tr><td></td><th class="com-table-form-th ui-widget-content ui-corner-all">Taille</th><th class="com-table-form-th ui-widget-content ui-corner-all">Prix</th></tr><tr><th class="com-table-form-th ui-widget-content ui-corner-all">Lot</th><td class="com-table-form-td"><input class="com-numeric com-input-text ui-widget-content ui-corner-all" name="taille" type="text" maxlength="12" id="ajout-produit-lots0taille"/></td><td class="com-table-form-td"><input class="com-numeric com-input-text ui-widget-content ui-corner-all" name="prix" type="text" maxlength="12" id="ajout-produit-lots0prix"/> {SIGLE_MONETAIRE}</td></tr><tr><td class="com-table-form-td"><br/></td></tr><tr><td colspan="3" style="text-align:center;"><input style="width:50%;" type="submit" value="Ajouter à la commande"/></td></tr></table></form></div></div><div id="liste_produit"></div><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><button type="button" id="btn-modifier-creation-commande" class="ui-helper-hidden">Modifier la commande</button><button type="button" id="btn-creer-commande">Créer la commande</button></div></div></div>';this.ajoutProduitAjoutCommande='<div class="produit-div com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all"><span class="produit-nom">{nom}</span><button type="button" class="com-delete">X</button></div><div class="com-widget-content"><span class="produit-id ui-helper-hidden">{idNom}</span>Quantité en stock <input class="ui-helper-hidden com-numeric" type="text" name="stock" value="{qteRestante}" id="produit-{idNom}-qteRestante" maxlength="11"/><span class="produit-stock">{qteRestante}</span><span class="produit-unite">{unite}</span><button type="button" class="edit-nom-pdt-creation-commande">Editer</button><br/>Quantité max par adhérent <input class="ui-helper-hidden com-numeric" type="text" name="qmax" value="{qteMaxCommande}" id="produit-{idNom}-qteMaxCommande" maxlength="11"/><span class="produit-qmax">{qteMaxCommande}</span> <input class="ui-helper-hidden" type="text" name="unite" value="{unite}" id="produit-{idNom}-unite" maxlength="20"/><span class="produit-unite">{unite}</span><div class="form-ajout-lot-creation-commande"><form><table><tr><td></td><td>Taille</td><td>Prix</td></tr><tr><td>Nouveau Lot : </td><td><input class="com-numeric" type="text" name="taille" id="ajout-lot-produit-{idNom}-taille" maxlength="12"/> <span class="produit-unite">{unite}</span></td><td><input class="com-numeric" type="text" name="prix" id="ajout-lot-produit-{idNom}-prix" maxlength="12"/> {siglemonetaire}</td><td><button type="button" class="btn-ajout-lot-creation-commande">Ajouter</button></td></tr></table></form></div><div class="produit-lots"><!-- BEGIN lots --><div class="produit-lot"><span class="lot-id ui-helper-hidden">0</span>Taille : <input class="ui-helper-hidden com-numeric" type="text" name="taille" value="{lots.taille}" id="produit-{idNom}-lot-0-taille" maxlength="12"/><span class="produit-taille">{lots.taille}</span> <span class="produit-unite">{unite}</span>   Prix : <input class="ui-helper-hidden com-numeric" type="text" name="prix" value="{lots.prix}" id="produit-{idNom}-lot-0-prix" maxlength="12" /><span class="produit-prix">{lots.prix}</span>{siglemonetaire}<button type="button" class="edit-lot-creation-commande">Editer</button><button type="button" class="ui-helper-hidden delete-lot">X</button></div><!-- END lots --></div></div></div>';this.ajoutLot='<div class="produit-lot"><span class="lot-id ui-helper-hidden">{id}</span>Taille : <input class="ui-helper-hidden com-numeric" type="text" name="taille" value="{taille}" id="produit-{idNom}-lot-{id}-taille" maxlength="12"><span class="produit-taille">{taille}</span> <span class="produit-unite">{unite}</span>   Prix : <input class="ui-helper-hidden com-numeric" type="text" name="prix" value="{prix}" id="produit-{idNom}-lot-{id}-prix" maxlength="12"><span class="produit-prix">{prix}</span>{siglemonetaire}<button type="button" class="edit-lot-creation-commande">Editer</button><button type="button" class="ui-helper-hidden delete-lot">X</button></div>';this.ajoutCommandeSucces='<div id="contenu"><div id="ajout_commande_succes" class="com-widget-window ui-widget ui-widget-content ui-corner-all com-div-ext-top"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Création de commande</div><div class="com-widget-content"><p>La commande n° : {numero} a été ajoutée avec succès.</p></div></div></div>';this.listeCommandePage='<div id="contenu"><div id="liste_commande_int"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Les Commandes en cours</div><table class="com-table"><tr class="ui-widget ui-widget-header"><th class="com-table-th">Numéro</th><th class="com-table-th">Date limite de Réservation</th><th class="com-table-th">Marché</th>	<th class="com-table-th"></th><th class="com-table-th"></th></tr><!-- BEGIN commande --><tr ><td class="com-table-td">{commande.numero}</td><td class="com-table-td">Le {commande.dateFinReservation} à {commande.heureFinReservation}H{commande.minuteFinReservation}</td><td class="com-table-td">Le {commande.dateMarcheDebut} de {commande.heureMarcheDebut}H{commande.minuteMarcheDebut} à {commande.heureMarcheFin}H{commande.minuteMarcheFin}</td><td class="com-table-td com-td-lien-bouton"><button class="btn-editer ui-state-default ui-corner-all com-button com-center" id="{commande.id}" >Editer</button></td><td class="com-table-td com-td-lien-bouton"><button class="btn-marche ui-state-default ui-corner-all com-button com-center" id="{commande.id}" >Marché</button></td></tr><!-- END commande --></table></div></div></div></div>';this.listeAdherentCommandePage='<div id="contenu"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Marché de la Commande N° {comNumero}</div><div class="recherche com-center com-widget-header ui-widget ui-widget-header ui-corner-all"><form id="filter-form">Recherche Rapide : <input  class="com-input-text ui-widget-content ui-corner-all" name="filter" id="filter" value="" maxlength="30" size="15" type="text" /></form></div><table class="com-table"><thead><tr class="ui-widget ui-widget-header com-cursor-pointer"><th class="com-table-th com-underline-hover"><span class="ui-icon span-icon"></span>Numéro Adhérent</th><th class="com-table-th com-underline-hover"><span class="ui-icon span-icon"></span>Numéro Compte</th><th class="com-table-th com-underline-hover"><span class="ui-icon span-icon"></span>Nom</th>	<th class="com-table-th com-underline-hover"><span class="ui-icon span-icon"></span>Prénom</th></tr></thead><tbody><!-- BEGIN listeAdherentCommande --><tr class="com-cursor-pointer achat-commande-ligne" ><td class="com-table-td com-underline-hover"><span class="ui-helper-hidden id-adherent">{listeAdherentCommande.adhId}</span>{listeAdherentCommande.adhNumero}</td><td class="com-table-td com-underline-hover">{listeAdherentCommande.adhLabelCompte}</td><td class="com-table-td com-underline-hover">{listeAdherentCommande.adhNom}</td><td class="com-table-td com-underline-hover">{listeAdherentCommande.adhPrenom}</td></tr><!-- END listeAdherentCommande --></tbody></table></div></div></div>';this.achatCommandePage='<div id="contenu"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Marché de la Commande N° {comNumero}</div><div class="com-widget-content"><span>N° d\'Adhérent : {adhNumero} N° de Compte : {adhCompte} Nom : {adhNom} Prénom : {adhPrenom}</span><br/><span>Solde Actuel : </span><span>{adhSolde} {sigleMonetaire}</span> <span>Nouveau Solde : </span><span id="nouveau-solde">{adhNouveauSolde}</span> <span id="nouveau-solde-sigle">{sigleMonetaire}</span></div></div><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Achat</div><div class="com-widget-content"><table><thead><tr><th>Produit</th><th>Quantité</th><th></th><th>Prix</th><th></th></tr></thead><tbody><!-- BEGIN produits --><tr class="ligne-produit"><td><span class="produit-id ui-helper-hidden">{produits.proId}</span>{produits.nproNom}</td><td class="com-text-align-right"><input type="text" value="{produits.stoQuantite}" class="com-numeric produit-quantite" id="produits{produits.proId}quantite" maxlength="12" size="3"/> </td><td>{produits.proUniteMesure}</td><td class="com-text-align-right" ><input type="text" value="{produits.proPrix}" class="com-numeric produit-prix" id="produits{produits.proId}prix" maxlength="12" size="3"/></td><td><span>{sigleMonetaire}</span></td></tr><!-- END produits --></tbody><tfoot><tr><td colspan="2"></td><td>Total :</td><td><span id="total-achat">{total}</span></td><td><span>{sigleMonetaire}</span></td></tr></tfoot></table></div></div><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Rechargement du compte</div><div class="com-widget-content"><table><thead><tr><th>Montant</th><th>Type de Paiement</th><th id="label-champ-complementaire"></th></tr></thead><tbody><tr><td><input type="text" name="montant-rechargement" value="" class="com-numeric" id="rechargementmontant" maxlength="12" size="3"/> <span>{sigleMonetaire}</span></td><td><select name="typepaiement" id="typepaiement"><!-- BEGIN typePaiement --><option value="{typePaiement.id}">{typePaiement.type}</option><!-- END typePaiement --></select></td><td id="td-champ-complementaire"><input type="text" name="champ-complementaire" value="" id="rechargementchampComplementaire" maxlength="50" size="15"/></td></tr></tbody></table></div></div><div class="com-widget-header ui-widget ui-widget-header ui-corner-all"><button type="button" id="btn-annuler">Annuler</button><button type="button" class="ui-helper-hidden" id="btn-modifier">Modifier</button><button type="button" id="btn-valider">Valider</button></div></div>';this.achatCommandeSucces='<div id="contenu"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Achat</div><div class="com-widget-content"><div><span class="com-float-left ui-icon ui-icon-check"></span>Achat effectué avec succès.</div><div><button id="btn-annuler">Retourner à la liste des commandes</button></div></div></div></div>';this.editerCommandePage='<div id="contenu"><div class="com-float-left" id="edt-com-info"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Commandes n°{comNumero}<span class="edt-com-btn-edt-commande ui-widget-content ui-corner-all"><span class="ui-icon ui-icon-trash"></span></span><span class="edt-com-btn-edt-commande ui-widget-content ui-corner-all"><span class="ui-icon ui-icon-disk"></span></span><span class="edt-com-btn-edt-commande ui-widget-content ui-corner-all"><span class="ui-icon ui-icon-pencil"></span></span></div><div>Fin des réservations : <br/>Le {dateFinReservation} à {heureFinReservation}H{minuteFinReservation} <br/>Marché : <br/>Le {dateMarcheDebut} de {heureMarcheDebut}H{minuteMarcheDebut} à {heureMarcheFin}H{minuteMarcheFin}</div></div><!-- BEGIN pdtCommande --><div class="com-widget-window ui-widget ui-widget-content ui-corner-all pdt-{pdtCommande.proId}-afficher-detail"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all com-cursor-pointer">{pdtCommande.nproNom}<span class="edt-com-btn-detail-pdt ui-widget-content ui-corner-all"><span class="ui-icon ui-icon-plus"></span></span></div><div><div class="edt-com-progressbar-pdt com-cursor-pointer" id="pdt-{pdtCommande.proId}"></div><div class="ui-helper-hidden" id="pdt-{pdtCommande.proId}-detail">Stock Initial : {pdtCommande.quantiteInit} {pdtCommande.proUniteMesure}<br/>Stock Actuel : {pdtCommande.quantite} {pdtCommande.proUniteMesure}<br/>Stock Commandé : {pdtCommande.quantiteCommande} {pdtCommande.proUniteMesure}<br/>Max par adhérent {pdtCommande.proMaxProduitCommande} {pdtCommande.proUniteMesure}<div><div>Lots : </div><!-- BEGIN pdtCommande.lot -->{pdtCommande.lot.dcomTaille} {pdtCommande.proUniteMesure} à {pdtCommande.lot.dcomPrix} {sigleMonetaire}<br/><!-- END pdtCommande.lot --></div></div></div></div><!-- END pdtCommande --></div><div class="com-float-left" id="edt-com-liste" ><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Liste des Réservation</div><div id="edt-com-recherche" class="com-widget-header ui-widget ui-widget-header ui-corner-all"><form id="filter-form"><div><input class="com-input-text ui-widget-content ui-corner-left" name="filter" id="filter" value="" maxlength="30" size="15" type="text" /><span class="ui-widget-content ui-corner-right edt-com-span-rech-right"><span class="ui-icon ui-icon-search"></span></span></div></form></div><table class="com-table"><thead><tr class="ui-widget ui-widget-header com-cursor-pointer"><th class="com-table-th com-underline-hover"><span class="ui-icon span-icon"></span>Numéro Adhérent</th><th class="com-table-th com-underline-hover"><span class="ui-icon span-icon"></span>Numéro Compte</th><th class="com-table-th com-underline-hover"><span class="ui-icon span-icon"></span>Nom</th>	<th class="com-table-th com-underline-hover"><span class="ui-icon span-icon"></span>Prénom</th></tr></thead><tbody><!-- BEGIN listeAdherentCommande --><tr class="com-cursor-pointer edt-com-reservation-ligne" ><td class="com-table-td com-underline-hover"><span class="ui-helper-hidden id-adherent">{listeAdherentCommande.adhId}</span>{listeAdherentCommande.adhNumero}</td><td class="com-table-td com-underline-hover">{listeAdherentCommande.adhLabelCompte}</td><td class="com-table-td com-underline-hover">{listeAdherentCommande.adhNom}</td><td class="com-table-td com-underline-hover">{listeAdherentCommande.adhPrenom}</td></tr><!-- END listeAdherentCommande --></tbody></table></div></div></div></div>';this.detailReservation='<div id="contenu"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Commandes n°{comNumero}</div><div>Fin des réservations : Le {dateFinReservation} à {heureFinReservation}H{minuteFinReservation} <br/>Marché : Le {dateMarcheDebut} de {heureMarcheDebut}H{minuteMarcheDebut} à {heureMarcheFin}H{minuteMarcheFin}</div></div><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Adhérent</div><div class="com-widget-content"><span>N° d\'Adhérent : {adhNumero} N° de Compte : {adhCompte} Nom : {adhNom} Prénom : {adhPrenom}</span><br/><span>Solde Actuel : </span><span>{adhSolde} {sigleMonetaire}</span></div></div><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Ma Commande</div><table class="com-table"><!-- BEGIN reservation --><tr ><td class="com-table-td">{reservation.nproNom}</td><td class="com-table-td">{reservation.stoQuantite}</td><td>{reservation.proUniteMesure}</td><td class="com-table-td">{reservation.prix}</td><td>{sigleMonetaire}</td></tr><!-- END reservation --><tr><td class="com-table-td" colspan="3">Total : </td><td class="com-table-td">{total}</td><td class="com-table-td">{sigleMonetaire}</td></tr></table></div><div class="boutons-edition com-widget-header ui-widget ui-widget-header ui-corner-all com-center"><button class="ui-state-default ui-corner-all com-button com-center" id="btn-annuler">Retour</button><button class="ui-state-default ui-corner-all com-button com-center" id="btn-modifier">Modifier</button><button class="ui-helper-hidden ui-state-default ui-corner-all com-button com-center">Supprimer</button></div></div>';this.modifierReservation='<div id="contenu"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Commandes n°{comNumero}</div><div>Fin des réservations : Le {dateFinReservation} à {heureFinReservation}H{minuteFinReservation} <br/>Marché : Le {dateMarcheDebut} de {heureMarcheDebut}H{minuteMarcheDebut} à {heureMarcheFin}H{minuteMarcheFin}</div></div><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Adhérent</div><div class="com-widget-content"><span>N° d\'Adhérent : {adhNumero} N° de Compte : {adhCompte} Nom : {adhNom} Prénom : {adhPrenom}</span><br/><span>Solde Actuel : </span><span>{adhSolde} {sigleMonetaire}</span> <span>Nouveau Solde : </span><span id="nouveau-solde">{adhNouveauSolde}</span> <span id="nouveau-solde-sigle">{sigleMonetaire}</span></div></div><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Ma Commande</div><div><table class="com-table"><!-- BEGIN produit --><tr class="pdt" id="pdt-{produit.proId}"><td><input type="checkbox" {produit.checked}/></td><td><span class="ui-helper-hidden"><span class="pdt-id">{produit.proId}</span></span></td><td colspan="5">{produit.nproNom}</td><td><span>{produit.proMaxProduitCommande}</span> <span>{produit.proUniteMesure}</span> Max</td><td colspan="3"></td></tr><!-- BEGIN produit.lot --><tr class="lot lot-pdt-{produit.proId}"><td><span class="ui-helper-hidden"><span class="pdt-id">{produit.proId}</span><span class="lot-id">{produit.lot.dcomId}</span></span></td><td><input type="radio" name="lot-produit-{produit.proId}" {produit.lot.checked}/></td><td>{produit.lot.dcomTaille}</td><td>{produit.proUniteMesure}</td><td>{produit.lot.dcomPrix}</td><td>{sigleMonetaire}</td><td><button class="btn-moins btn-pdt-{produit.proId}" id="btn-moins-lot-{produit.lot.dcomId}">-</button></td><td><span id="colonne-qte-pdt-{produit.proId}-lot-{produit.lot.dcomId}" class="colonne-pdt-{produit.proId}"><span id="qte-pdt-{produit.proId}-lot-{produit.lot.dcomId}" class="qte">{produit.lot.stoQuantiteReservation}</span> <span>{produit.proUniteMesure}</span></span></td><td><button class="btn-plus btn-pdt-{produit.proId}" id="btn-plus-lot-{produit.lot.dcomId}">+</button></td><td><span id="colonne-prix-pdt-{produit.proId}-lot-{produit.lot.dcomId}" class="colonne-pdt-{produit.proId}"><span id="prix-pdt-{produit.proId}-lot-{produit.lot.dcomId}">{produit.lot.prixReservation}</span></span></td><td><span id="colonne-sigle-pdt-{produit.proId}-lot-{produit.lot.dcomId}" class="colonne-pdt-{produit.proId}">{sigleMonetaire}</span></td></tr><!-- END produit.lot --><!-- END produit --><tr><td colspan="9">Total : </td><td><span id="total">{total}</span></td><td>{sigleMonetaire}</td></tr></table></div></div><div class="com-widget-header ui-widget ui-widget-header ui-corner-all com-center"><button class="ui-state-default ui-corner-all com-button com-center" id="btn-annuler">Annuler</button><button class="ui-state-default ui-corner-all com-button com-center" id="btn-valider">Valider</button></div></div>'}function IdentificationTemplate(){this.debutMenu='<div id="menu_int" ><ul id="menu_liste" >';this.finMenu="</ul></div>";this.deconnexion='<span id="lien-deconnexion" class="ui-widget-header ui-corner-bl"><a href="./index.php?m=Identification&amp;v=Deconnexion" ><span class="com-float-left ui-icon ui-icon-power"></span>Déconnexion</a></span>';this.administration='<span id="lien-administration" class="com-cursor-pointer ui-widget-header ui-corner-tl"><span class="com-float-left ui-icon ui-icon-gear"></span>Administration</span>';this.module='<!-- BEGIN modules --><li><a class="ui-widget-header {modules.CLASS}" id="menu-{modules.MODULE_NOM}-{modules.NOM}" href="./index.php?m={modules.MODULE_NOM}&amp;v={modules.NOM}">{modules.MODULE_LABEL}</a><ul class="sous_menu ui-widget-content ui-corner-bottom"><!-- BEGIN vues --><li class="ui-corner-all"><a id="menu-{modules.MODULE_NOM}-{modules.vues.NOM}" href="./index.php?m={modules.MODULE_NOM}&amp;v={modules.vues.NOM}">{modules.vues.LABEL}</a></li><br/><!-- END vues --></ul></li><!-- END modules -->';this.nouveauModule='<!-- BEGIN modules --><li><a class="ui-widget-header menu-lien" id="menu-{modules.moduleNom}-{modules.nom}" href="./index.php?m={modules.moduleNom}&amp;v={modules.nom}">{modules.label}</a></li><!-- END modules -->';this.admin='<div id="contenu"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Administration</div><div><ul><!-- BEGIN modules --><li><span id="menu-{modules.moduleNom}-{modules.nom}" >{modules.label}</span><ul><!-- BEGIN vues --><li><a id="menu-{modules.moduleNom}-{modules.vues.nom}" href="./index.php?m={modules.moduleNom}&amp;v={modules.vues.nom}">{modules.vues.label}</a></li><br/><!-- END vues --></ul></li><!-- END modules --></ul></div></div></div>'}function MonCompteTemplate(){this.detailReservation='<div id="contenu"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Commandes n°{comNumero}</div><div>Fin des réservations : Le {dateFinReservation} à {heureFinReservation}H{minuteFinReservation} <br/>Marché : Le {dateMarcheDebut} de {heureMarcheDebut}H{minuteMarcheDebut} à {heureMarcheFin}H{minuteMarcheFin}</div></div><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Ma Commande</div><table class="com-table"><!-- BEGIN reservation --><tr ><td class="com-table-td">{reservation.nproNom}</td><td class="com-table-td">{reservation.stoQuantite}</td><td>{reservation.proUniteMesure}</td><td class="com-table-td">{reservation.prix}</td><td>{sigleMonetaire}</td></tr><!-- END reservation --><tr><td class="com-table-td" colspan="3">Total : </td><td class="com-table-td">{total}</td><td class="com-table-td">{sigleMonetaire}</td></tr></table></div><div class="boutons-edition com-widget-header ui-widget ui-widget-header ui-corner-all com-center"><button class="ui-state-default ui-corner-all com-button com-center" id="btn-modifier">Modifier</button><button class="ui-helper-hidden ui-state-default ui-corner-all com-button com-center">Supprimer</button></div></div>';this.modifierReservation='<div id="contenu"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Commandes n°{comNumero}</div><div>Fin des réservations : Le {dateFinReservation} à {heureFinReservation}H{minuteFinReservation} <br/>Marché : Le {dateMarcheDebut} de {heureMarcheDebut}H{minuteMarcheDebut} à {heureMarcheFin}H{minuteMarcheFin}</div></div><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Ma Commande</div><div><table class="com-table"><!-- BEGIN produit --><tr class="pdt" id="pdt-{produit.proId}"><td><input type="checkbox" {produit.checked}/></td><td><span class="ui-helper-hidden"><span class="pdt-id">{produit.proId}</span></span></td><td colspan="5">{produit.nproNom}</td><td><span>{produit.proMaxProduitCommande}</span> <span>{produit.proUniteMesure}</span> Max</td><td colspan="3"></td></tr><!-- BEGIN produit.lot --><tr class="lot lot-pdt-{produit.proId}"><td><span class="ui-helper-hidden"><span class="pdt-id">{produit.proId}</span><span class="lot-id">{produit.lot.dcomId}</span></span></td><td><input type="radio" name="lot-produit-{produit.proId}" {produit.lot.checked}/></td><td>{produit.lot.dcomTaille}</td><td>{produit.proUniteMesure}</td><td>{produit.lot.dcomPrix}</td><td>{sigleMonetaire}</td><td><button class="btn-moins btn-pdt-{produit.proId}" id="btn-moins-lot-{produit.lot.dcomId}">-</button></td><td><span id="colonne-qte-pdt-{produit.proId}-lot-{produit.lot.dcomId}" class="colonne-pdt-{produit.proId}"><span id="qte-pdt-{produit.proId}-lot-{produit.lot.dcomId}" class="qte">{produit.lot.stoQuantiteReservation}</span> <span>{produit.proUniteMesure}</span></span></td><td><button class="btn-plus btn-pdt-{produit.proId}" id="btn-plus-lot-{produit.lot.dcomId}">+</button></td><td><span id="colonne-prix-pdt-{produit.proId}-lot-{produit.lot.dcomId}" class="colonne-pdt-{produit.proId}"><span id="prix-pdt-{produit.proId}-lot-{produit.lot.dcomId}">{produit.lot.prixReservation}</span></span></td><td><span id="colonne-sigle-pdt-{produit.proId}-lot-{produit.lot.dcomId}" class="colonne-pdt-{produit.proId}">{sigleMonetaire}</span></td></tr><!-- END produit.lot --><!-- END produit --><tr><td colspan="9">Total : </td><td><span id="total">{total}</span></td><td>{sigleMonetaire}</td></tr></table></div></div><div class="com-widget-header ui-widget ui-widget-header ui-corner-all com-center"><button class="ui-state-default ui-corner-all com-button com-center" id="btn-annuler">Annuler</button><button class="ui-state-default ui-corner-all com-button com-center" id="btn-valider">Valider</button></div></div>';this.listeReservation='<div id="contenu"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Mes Commandes</div><table class="com-table"><tr class="ui-widget ui-widget-header"><th class="com-table-th">Commande N°</th><th class="com-table-th">Date limite de Réservation</th><th class="com-table-th">Marché</th>	</tr><!-- BEGIN reservation --><tr class="com-cursor-pointer visualiser-reservation" id={reservation.idCommande} ><td class="com-table-td com-underline-hover">{reservation.numero}</td><td class="com-table-td com-underline-hover">Le {reservation.dateFinReservation} à {reservation.heureFinReservation}H{reservation.minuteFinReservation}</td><td class="com-table-td com-underline-hover">Le {reservation.dateMarcheDebut} de {reservation.heureMarcheDebut}H{reservation.minuteMarcheDebut} à {reservation.heureMarcheFin}H{reservation.minuteMarcheFin}</td></tr><!-- END reservation --></table></div><div class="ui-helper-hidden com-widget-header ui-widget ui-widget-header ui-corner-all com-center"><button class="ui-state-default ui-corner-all com-button com-center">Anciennes commandes</button></div></div>';this.listeReservationVide='<div id="contenu"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Mes Commandes</div>Aucune réservation en cours.</div><div class="ui-helper-hidden com-widget-header ui-widget ui-widget-header ui-corner-all com-center"><button class="ui-state-default ui-corner-all com-button com-center">Anciennes commandes</button></div></div>'}function CommandeTemplate(){this.detailReservation='<div id="contenu"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Commandes n°{comNumero}</div><div>Fin des réservations : Le {dateFinReservation} à {heureFinReservation}H{minuteFinReservation} <br/>Marché : Le {dateMarcheDebut} de {heureMarcheDebut}H{minuteMarcheDebut} à {heureMarcheFin}H{minuteMarcheFin}</div></div><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Ma Commande</div><table class="com-table"><!-- BEGIN reservation --><tr ><td class="com-table-td">{reservation.nproNom}</td><td class="com-table-td">{reservation.stoQuantite}</td><td>{reservation.proUniteMesure}</td><td class="com-table-td">{reservation.prix}</td><td>{sigleMonetaire}</td></tr><!-- END reservation --><tr><td class="com-table-td" colspan="3">Total : </td><td class="com-table-td">{total}</td><td class="com-table-td">{sigleMonetaire}</td></tr></table></div><div class="boutons-edition com-widget-header ui-widget ui-widget-header ui-corner-all com-center"><button class="ui-state-default ui-corner-all com-button com-center" id="btn-modifier">Modifier</button><button class="ui-state-default ui-corner-all com-button com-center" id="btn-valider">Valider</button></div></div>';this.reservation='<div id="contenu"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Commandes n°{comNumero}</div><div>Fin des réservations : Le {dateFinReservation} à {heureFinReservation}H{minuteFinReservation} <br/>Marché : Le {dateMarcheDebut} de {heureMarcheDebut}H{minuteMarcheDebut} à {heureMarcheFin}H{minuteMarcheFin}</div></div><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Ma Commande</div><div><table class="com-table"><!-- BEGIN produit --><tr class="pdt" id="pdt-{produit.proId}"><td><input type="checkbox" {produit.checked}/></td><td><span class="ui-helper-hidden"><span class="pdt-id">{produit.proId}</span></span></td><td colspan="5">{produit.nproNom}</td><td><span>{produit.proMaxProduitCommande}</span> <span>{produit.proUniteMesure}</span> Max</td><td colspan="3"></td></tr><!-- BEGIN produit.lot --><tr class="lot lot-pdt-{produit.proId}"><td><span class="ui-helper-hidden"><span class="pdt-id">{produit.proId}</span><span class="lot-id">{produit.lot.dcomId}</span></span></td><td><input type="radio" name="lot-produit-{produit.proId}" {produit.lot.checked}/></td><td>{produit.lot.dcomTaille}</td><td>{produit.proUniteMesure}</td><td>{produit.lot.dcomPrix}</td><td>{sigleMonetaire}</td><td><button class="btn-moins btn-pdt-{produit.proId}" id="btn-moins-lot-{produit.lot.dcomId}">-</button></td><td><span id="colonne-qte-pdt-{produit.proId}-lot-{produit.lot.dcomId}" class="colonne-pdt-{produit.proId}"><span id="qte-pdt-{produit.proId}-lot-{produit.lot.dcomId}" class="qte">{produit.lot.stoQuantiteReservation}</span> <span>{produit.proUniteMesure}</span></span></td><td><button class="btn-plus btn-pdt-{produit.proId}" id="btn-plus-lot-{produit.lot.dcomId}">+</button></td><td><span id="colonne-prix-pdt-{produit.proId}-lot-{produit.lot.dcomId}" class="colonne-pdt-{produit.proId}"><span id="prix-pdt-{produit.proId}-lot-{produit.lot.dcomId}">{produit.lot.prixReservation}</span></span></td><td><span id="colonne-sigle-pdt-{produit.proId}-lot-{produit.lot.dcomId}" class="colonne-pdt-{produit.proId}">{sigleMonetaire}</span></td></tr><!-- END produit.lot --><!-- END produit --><tr><td colspan="9">Total : </td><td><span id="total">{total}</span></td><td>{sigleMonetaire}</td></tr></table></div></div><div class="com-widget-header ui-widget ui-widget-header ui-corner-all com-center"><button class="ui-state-default ui-corner-all com-button com-center" id="btn-valider">Valider</button></div></div>';this.listeCommandePage='<div id="contenu"><div id="liste_commande_int"><div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Les Commandes en cours</div><table class="com-table"><tr class="ui-widget ui-widget-header"><th class="com-table-th">Numéro</th><th class="com-table-th">Date limite de Réservation</th><th class="com-table-th">Marché</th>	<th class="com-table-th"></th></tr><!-- BEGIN commande --><tr ><td class="com-table-td">{commande.numero}</td><td class="com-table-td">Le {commande.dateFinReservation} à {commande.heureFinReservation}H{commande.minuteFinReservation}</td><td class="com-table-td">Le {commande.dateMarcheDebut} de {commande.heureMarcheDebut}H{commande.minuteMarcheDebut} à {commande.heureMarcheFin}H{commande.minuteMarcheFin}</td><td class="com-table-td com-td-lien-bouton"><button class="btn-commander ui-state-default ui-corner-all com-button com-center" id="{commande.id}">Commander</button></td></tr><!-- END commande --></table></div></div></div></div>';this.confirmationReservationCommande='<div class="com-widget-window ui-widget ui-widget-content ui-corner-all"><table><!-- BEGIN produit --><tr><td>{produit.NOM}</td><td>{produit.QUANTITE}</td><td>{produit.PRIX}</td></tr><!-- END produit --><tr><td></td><td>Total : </td><td>{TOTAL_COMMANDE}</td></tr></table><div class="ui-helper-hidden"><form id="form-confirmation-reservation-commande"><table><tr><td><input type="text" name="id_commande" value="{ID_COMMANDE}" /></td></tr><!-- BEGIN info_produit --><tr><td><input type="text" name="id_pdt[]" value="{info_produit.IDPDT}" /></td><td><input type="text" name="id_lot[]" value="{info_produit.IDLOT}" /></td><td><input type="text" name="qte[]" value="{info_produit.QTE}" /></td></tr><!-- END info_produit --></table></form></div></div>';this.reservationOk='<div id="contenu"><div class="ui-widget ui-widget-content ui-corner-all"><div class="com-widget-header ui-widget ui-widget-header ui-corner-all">Réservation</div><span class="com-float-left ui-icon ui-icon-check"></span><span>Réservation effectuée avec succés.</span></div></div>'}$(function(){$.datepicker.setDefaults($.datepicker.regional.fr);var a=$("#date_naissance, #date_adhesion").datepicker({changeMonth:true,changeYear:true,onSelect:function(d){var e=this.id=="date_naissance"?"minDate":"maxDate";var b=$(this).data("datepicker");var c=$.datepicker.parseDate(b.settings.dateFormat||$.datepicker._defaults.dateFormat,d,b.settings);a.not(this).datepicker("option",e,c)}})});const gTempsTransition=150;const gTempsTransitionUnique=gTempsTransition*2;const gSigleMonetaire="€";const gTextEdition="Editer";const gTextValider="Valider";var TemplateData=new TemplateData();var Infobulle=new Infobulles();$(document).ready(function(){$("#widget_message_information").click(function(){$(this).delay(gTempsTransition).fadeOut(gTempsTransitionUnique)});$("#loading").ajaxStart(function(){$(this).fadeIn(gTempsTransition)});$("#loading").ajaxStop(function(){$(this).fadeOut(gTempsTransition)});if($("#contenu_message_information").html()!=""){$("#widget_message_information").delay(gTempsTransition).fadeIn(gTempsTransitionUnique)}$(".com-button:not(.ui-state-disabled)").hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")}).mousedown(function(){$(this).addClass("ui-state-active")}).mouseup(function(){$(this).removeClass("ui-state-active")});$("#lien_gestion_adherent_operation").click(function(){$("#widget_formulaire_ajout_operation_adherent").slideToggle()});$.datepicker.setDefaults($.datepicker.regional.fr);$(".com-date").datepicker({changeMonth:true,changeYear:true})});function CommunVue(){this.comDelete=function(a){a.find(".com-delete").click(function(){$(this).parent().parent().remove()});return a};this.comNumeric=function(a){if($(a).length!=0){a.find(".com-numeric").numeric(",")}else{$("body").find(".com-numeric").numeric(",")}return a};this.comLienDatepicker=function(d,a,b){$.datepicker.setDefaults($.datepicker.regional.fr);var c=b.find("#"+d+",#"+a).datepicker({changeMonth:true,changeYear:true,onSelect:function(g){var h=this.id==d?"minDate":"maxDate";var e=$(this).data("datepicker");var f=$.datepicker.parseDate(e.settings.dateFormat||$.datepicker._defaults.dateFormat,g,e.settings);c.not(this).datepicker("option",h,f)}});return b}}function MenuVue(){this.mMenuTemplate=new IdentificationTemplate();this.construct=function(){var a=this;$.post("./index.php?m=Identification&v=Menu",function(b){Infobulle.init();if(b.valid){a.afficherNouveau(b)}else{Infobulle.generer(b,"")}},"json")};this.afficherNouveau=function(b){var a=this;$("#menu_int").replaceWith(a.genererNouveauMenu(b.menu));$("#site").append(a.affectHover($(a.mMenuTemplate.deconnexion)));if(b.admin){$("#site").append(a.affectAdministration($(a.mMenuTemplate.administration)))}};this.genererNouveauMenu=function(b){var a=this.mMenuTemplate.debutMenu;a+=this.genererNouveauModule(b);a+=this.mMenuTemplate.finMenu;a=$(a);a.find(".menu-lien").first().addClass("ui-corner-tl");a.find(".menu-lien").last().addClass("ui-corner-br");a.find(".menu-lien").hover(function(){a.find(".menu-lien").removeClass("ui-state-hover");$(this).addClass("ui-state-hover")},function(){a.find(".menu-lien").removeClass("ui-state-hover")});a=this.affectVues(a);return a};this.affectHover=function(a){a.hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")});return a};this.genererNouveauModule=function(a){var b=this.mMenuTemplate.nouveauModule;return b.template(a)};this.affectAdministration=function(a){a.click(function(){AdministrationVue()});a=this.affectHover(a);return a};this.afficher=function(b){var a=this;$("#menu_int").replaceWith(a.genererMenu(b));$("#site").append(a.mMenuTemplate.deconnexion)};this.genererMenu=function(b){var a=this.mMenuTemplate.debutMenu;a+=this.genererModule(b);a+=this.mMenuTemplate.finMenu;a=$(a);a=this.affectVues(a);a=this.affectAnimation(a);return a};this.genererModule=function(a){var b=this.mMenuTemplate.module;return b.template(a)};this.affectVues=function(a){if(a){a.find("#menu-MonCompte-MesCommandes").click(function(){var b=new ListeReservationVue();b.construct();return false});a.find("#menu-Commande-ListeCommande").click(function(){var b=new ListeCommandeVue();b.construct();return false});a.find("#menu-GestionCommande-ListeCommande").click(function(){var b=new GestionListeCommandeVue();b.construct();return false});a.find("#menu-GestionCommande-AjoutCommande").click(function(){var b=new AjoutCommandeVue();b.construct();return false});return a}return null};this.construct()}$(document).ready(function(){MenuVue()});function AdministrationVue(){this.construct=function(){var a=this;$.post("./index.php?m=Identification&v=Administration",function(b){Infobulle.init();if(b.valid){a.afficher(b)}else{Infobulle.generer(b,"")}},"json")};this.afficher=function(a){var b=this;var d=new IdentificationTemplate();var c=d.admin;$("#contenu").replaceWith(b.affect($(c.template(a.menu))))};this.affect=function(a){a=this.affectVues(a);return a};this.affectVues=function(a){if(a){a.find("#menu-GestionCommande-ListeCommande").click(function(){var b=new GestionListeCommandeVue();b.construct();return false});a.find("#menu-GestionCommande-AjoutCommande").click(function(){var b=new AjoutCommandeVue();b.construct();return false});return a}return null};this.construct()}function AjoutAdherentVue(){this.mCommunVue=new CommunVue();this.affect=function(){this.boutonLienCompte();this.mCommunVue.comNumeric()};this.boutonLienCompte=function(){$(":input[name=lien_numero_compte]").click(function(){if($(":input[name=numero_compte]").attr("disabled")){$(":input[name=numero_compte]").removeAttr("disabled")}else{$(":input[name=numero_compte]").attr("disabled","disabled").val("")}})}}$(document).ready(function(){var a=new AjoutAdherentVue();a.affect()});function GestionListeCommandeVue(){this.construct=function(){var a=this;$.post("./index.php?m=GestionCommande&v=ListeCommande",function(b){Infobulle.init();if(b.valid){a.afficher(b)}else{Infobulle.generer(b,"")}},"json")};this.afficher=function(c){var b=this;var d=new Object;d.commande=new Array();$(c.listeCommande).each(function(){var f=new Object();f.id=this.comId;f.numero=this.comNumero;f.dateFinReservation=this.comDateFinReservation.extractDbDate().dateDbToFr();f.heureFinReservation=this.comDateFinReservation.extractDbHeure();f.minuteFinReservation=this.comDateFinReservation.extractDbMinute();f.dateMarcheDebut=this.comDateMarcheDebut.extractDbDate().dateDbToFr();f.heureMarcheDebut=this.comDateMarcheDebut.extractDbHeure();f.minuteMarcheDebut=this.comDateMarcheDebut.extractDbMinute();f.heureMarcheFin=this.comDateMarcheFin.extractDbHeure();f.minuteMarcheFin=this.comDateMarcheFin.extractDbMinute();d.commande.push(f)});var a=new GestionCommandeTemplate();var e=a.listeCommandePage;$("#contenu").replaceWith(b.affect($(e.template(d))))};this.affect=function(a){a=this.affectLienEditer(a);a=this.affectLienMarche(a);return a};this.affectLienEditer=function(a){a.find(".btn-editer").click(function(){var b={id_commande:$(this).attr("id")};EditerCommandeVue(b)});return a};this.affectLienMarche=function(a){a.find(".btn-marche").click(function(){var b=new MarcheCommandeVue();b.construct($(this).attr("id"))});return a}}function AjoutCommandeVue(){this.etapeCreationCommande=0;this.mCommunVue=new CommunVue();this.mControleur=new AjoutCommandeControleur();this.construct=function(){var a=this;$.post("./index.php?m=GestionCommande&v=AjoutCommande",function(b){Infobulle.init();if(b.valid){a.afficher(b)}else{Infobulle.generer(b,"")}},"json")};this.afficher=function(b){var c=this;var a=new GestionCommandeTemplate();var d=a.formulaireAjoutCommande;$("#contenu").replaceWith(c.affect($(d.template(b))))};this.affect=function(a){a=this.affectAjoutProduit(a);a=this.affectCreerCommande(a);a=this.affectModifierCommande(a);a=this.affectDialogCreerProduit(a);a=this.affectControleDatepicker(a);a=this.mCommunVue.comNumeric(a);return a};this.affectNouveauProduit=function(a){a=this.mCommunVue.comDelete(a);a=this.mCommunVue.comNumeric(a);a=this.editProduit(a);a=this.ajoutLotProduit(a);a=this.affectAjoutLot(a);return a};this.affectAjoutLot=function(a){a=this.editLot(a);a=this.deleteLot(a);return a};this.affectAjoutProduit=function(a){var c="#formulaire-ajout-produit-creation-commande";var b=this;a.find(c).submit(function(){var g=true;$(".produit-id").each(function(){if(parseInt($(this).text())==$(c+" :input[name=produit]").val()){g=false}});if(g){var f=new ProduitCommandeVO();f.idNom=$(c+" :input[name=produit]").val();f.nom=$(c+" :input[name=produit] option:selected").text();f.unite=$(c+" :input[name=unite]").val();f.qteMaxCommande=$(c+" :input[name=qmax]").val().numberFrToDb();f.qteRestante=$(c+" :input[name=stock]").val().numberFrToDb();var k=new DetailCommandeVO();k.taille=$(c+" :input[name=taille]").val().numberFrToDb();k.prix=$(c+" :input[name=prix]").val().numberFrToDb();f.lots.push(k);var j=b.mControleur.validAjoutProduit(f);if(j.valid){Infobulle.init();var d=new GestionCommandeTemplate();var h=d.ajoutProduitAjoutCommande;f.lots[0].prix=parseFloat(f.lots[0].prix).nombreFormate(2,","," ");f.siglemonetaire=gSigleMonetaire;$("#liste_produit").append(b.affectNouveauProduit($(h.template(f))));$(c+" :input[name=unite]").val("");$(c+" :input[name=qmax]").val("");$(c+" :input[name=stock]").val("");$(c+" :input[name=taille]").val("");$(c+" :input[name=prix]").val("")}else{Infobulle.generer(j,"ajout-produit-")}}else{var j=new TemplateVR();j.valid=false;j.log.valid=false;var e=new VRerreur();e.code=ERR_211_CODE;e.message=ERR_211_MSG;j.log.erreurs.push(e);Infobulle.generer(j,"")}return false});return a};this.affectCreerCommande=function(a){var c="#btn-creer-commande";var b=this;a.find(c).click(function(){var d=true;$("#liste_produit").find(":button").each(function(){if($(this).text()==gTextValider){d=false}});if(d){var f=new CommandeCompleteVO();f.nom=$("#formulaire-information-creation-commande").find(":input[name=nom_commande]").val();f.description=$("#formulaire-information-creation-commande").find(":input[name=description_commande]").val();f.dateMarcheDebut=$("#formulaire-information-creation-commande").find(":input[name=date_debut_marche]").val().dateFrToDb();f.timeMarcheDebut=$("#formulaire-information-creation-commande").find(":input[name=heure_debut_marche]").val()+":"+$("#formulaire-information-creation-commande").find(":input[name=minute_debut_marche]").val()+":00";f.dateMarcheFin=$("#formulaire-information-creation-commande").find(":input[name=date_debut_marche]").val().dateFrToDb();f.timeMarcheFin=$("#formulaire-information-creation-commande").find(":input[name=heure_fin_marche]").val()+":"+$("#formulaire-information-creation-commande").find(":input[name=minute_fin_marche]").val()+":00";f.dateFinReservation=$("#formulaire-information-creation-commande").find(":input[name=date_fin_commande]").val().dateFrToDb();f.timeFinReservation=$("#formulaire-information-creation-commande").find(":input[name=heure_fin_commande]").val()+":"+$("#formulaire-information-creation-commande").find(":input[name=minute_fin_commande]").val()+":00";f.archive="0";$(".produit-div").each(function(){var h=new ProduitCommandeVO();h.idNom=$(this).find(".produit-id").text();h.unite=$(this).find(":input[name=unite]").val();h.qteMaxCommande=$(this).find(":input[name=qmax]").val().numberFrToDb();h.qteRestante=$(this).find(":input[name=stock]").val().numberFrToDb();$(this).find(".produit-lot").each(function(){var j=new DetailCommandeVO();j.taille=$(this).find(":input[name=taille]").val().numberFrToDb();j.prix=$(this).find(":input[name=prix]").val().numberFrToDb();h.lots.push(j)});f.produits.push(h)});if(b.etapeCreationCommande==0){var g=b.mControleur.valid(f);if(g.valid){b.etapeCreationCommande=1;Infobulle.init();$("#window-ajout-produit-creation-commande").hide();$("#btn-modifier-creation-commande").show();$("#liste_produit .produit-div :button , .form-ajout-lot-creation-commande").each(function(){$(this).hide()});$("#formulaire-information-creation-commande :input[type=text], #formulaire-information-creation-commande :input[type=textarea], #formulaire-information-creation-commande select").each(function(){$(this).inputToText()})}else{Infobulle.generer(g,"commande-")}}else{if(b.etapeCreationCommande==1){$.post("./index.php?m=GestionCommande&v=AjoutCommande","commande="+$.toJSON(f)+"&form=2",function(j){if(j.valid){var h=new GestionCommandeTemplate();var k=h.ajoutCommandeSucces;$("#contenu").replaceWith(k.template(j))}else{b.modifierCommandeFunction();Infobulle.generer(j,"commande-")}b.etapeCreationCommande=0},"json")}}}else{var g=new Object();var e=new VRerreur();e.code=ERR_112_CODE;e.message=ERR_112_MSG;g.valid=false;g.log=new VRelement();g.log.valid=false;g.log.erreurs.push(e);Infobulle.generer(g,"")}});return a};this.affectModifierCommande=function(a){var b=this;a.find("#btn-modifier-creation-commande").click(function(){b.modifierCommandeFunction()});return a};this.modifierCommandeFunction=function(){this.etapeCreationCommande=0;var a=this;$("#window-ajout-produit-creation-commande, #liste_produit .produit-div :button, .form-ajout-lot-creation-commande").show();$("#btn-modifier-creation-commande").hide();$(".produit-lots").each(function(){a.afficherDeleteLot($(this))});$("#formulaire-information-creation-commande :input[type=text], #formulaire-information-creation-commande :input[type=textarea], #formulaire-information-creation-commande select").textToInput()};this.ajoutLotProduit=function(a){var b=this;a.find(".btn-ajout-lot-creation-commande").click(function(){var f=$(this).parents(".form-ajout-lot-creation-commande").find(":input[name=taille]");var c=$(this).parents(".form-ajout-lot-creation-commande").find(":input[name=prix]");var e=new DetailCommandeVO();e.idProduit=$(this).parents(".produit-div").find(".produit-id").text();e.taille=f.val().numberFrToDb();e.prix=c.val().numberFrToDb();var j=b.mControleur.validAjoutLot(e);if(j.valid){Infobulle.init();e.prix=parseFloat(e.prix).nombreFormate(2,","," ");e.siglemonetaire=gSigleMonetaire;e.unite=$(this).parentsUntil(".produit-div").find(":input[name=unite]").val();e.idNom=e.idProduit;var h=new Array();$(this).parentsUntil(".produit-div").find(".produit-lot").each(function(){h.push(parseInt($(this).find(".lot-id").text()))});e.id=Array.max(h)+1;var d=new GestionCommandeTemplate();var g=d.ajoutLot;b.afficherDeleteLot($(this).parents(".produit-div").find(".produit-lots").append(b.affectAjoutLot($(g.template(e)))));f.val("");c.val("")}else{Infobulle.generer(j,"ajout-lot-produit-"+e.idProduit+"-")}});return a};this.editProduit=function(a){var b=this;a.find(".edit-nom-pdt-creation-commande").click(function(){if($(this).text()==gTextEdition){$(this).text(gTextValider);$(this).parent().children(":input:not(:button,:submit)").each(function(){$(this).textToInput()})}else{var c=new ProduitCommandeVO();var e=$(this).parentsUntil(".produit-div");c.idNom=$(e).find(".produit-id").text();c.nom=$(e).find(".produit-nom").text();c.unite=$(e).find(":input[name=unite]").val();c.qteMaxCommande=$(e).find(":input[name=qmax]").val().numberFrToDb();c.qteRestante=$(e).find(":input[name=stock]").val().numberFrToDb();var f=b.mControleur.validAjoutProduitSimple(c);if(f.valid){Infobulle.init();$(this).text(gTextEdition);$(this).parent().children(":input:not(:button,:submit)").each(function(){$(this).inputToText()});var d=$(this).parentsUntil("#liste_produit");d.find(".produit-unite").text(d.children(":input[name=unite]").val())}else{Infobulle.generer(f,"produit-"+c.idNom+"-")}}});return a};this.editLot=function(a){var b=this;a.find(".edit-lot-creation-commande").click(function(){if($(this).text()==gTextEdition){$(this).text(gTextValider);$(this).parent().children(":input:not(:button,:submit)").each(function(){$(this).textToInput()})}else{var c=new DetailCommandeVO();var d=$(this).parent(".produit-lot");c.id=$(d).find(".lot-id").text();c.idProduit=$(this).parentsUntil(".produit-div").find(".produit-id").text();c.taille=$(d).find(":input[name=taille]").val().numberFrToDb();c.prix=$(d).find(":input[name=prix]").val().numberFrToDb();var e=b.mControleur.validAjoutLot(c);if(e.valid){Infobulle.init();$(this).text(gTextEdition);$(this).parent().find(":input[name='taille']").inputToText();$(this).parent().find(":input[name='prix']").inputToText("montant")}else{Infobulle.generer(e,"produit-"+c.idProduit+"-lot-"+c.id+"-")}}});return a};this.deleteLot=function(a){var b=this;a.find(".delete-lot").click(function(){var c=$(this).parents(".produit-lots");$(this).parent().remove();b.afficherDeleteLot(c)});return a};this.afficherDeleteLot=function(a){if(a.children(".produit-lot").size()<2){a.find(".delete-lot").hide()}else{a.find(".delete-lot").show()}return a};this.affectDialogCreerProduit=function(a){a.find("#dialog-form-creer-nv-pdt").dialog({autoOpen:false,modal:true,draggable:false,resizable:false,width:400,buttons:{"Créer le produit":function(){var b=$(this).children("form").first();var c=b.find(":input[name=nom]");var d=true;$("#dialog-form-creer-nv-pdt").children().first().html("").hide();b.find(":input").removeClass("ui-state-error");d=c.checkLength(1,50);if(d){$.post("./index.php?m=GestionCommande&v=AjoutCommande",b.serialize()+"&form=1",function(e){if(e.succes==true){$("#formulaire-ajout-produit-creation-commande select[name=produit]").addOption(e.produit,true).sortOptions();$("#dialog-form-creer-nv-pdt").dialog("close")}else{var f='<div class="ui-state-error ui-corner-all" style="padding: 0 .7em;"><p><span class="ui-icon ui-icon-alert" style="float: left; margin-right: .3em;"></span><strong>Erreur : </strong> L\'ajout n\'a pas été effectué.<br/><!-- BEGIN erreurs --><strong>Code Erreur : </strong>{erreurs.CODE_ERREUR}<br/><strong>Message Erreur : </strong>{erreurs.MESSAGE_ERREUR}<br/><!-- END erreurs --></p></div>';$("#dialog-form-creer-nv-pdt").children().first().html(f.template(e)).fadeIn(gTempsTransitionUnique)}},"json")}},Annuler:function(){$(this).dialog("close")}},close:function(){$(this).children("form").first().find(":input").val("").removeClass("ui-state-error");$("#dialog-form-creer-nv-pdt").children().first().html("").hide()}});a.find("#btn-creer-nv-pdt").click(function(){$("#dialog-form-creer-nv-pdt").dialog("open")});return a};this.affectControleDatepicker=function(a){a=this.mCommunVue.comLienDatepicker("commande-dateFinReservation","commande-dateMarcheDebut",a);return a}}function AchatCommandeVue(){this.idCommande=null;this.idAdherent=null;this.idCompte=null;this.listeLot=new Array();this.typePaiement=null;this.solde=null;this.mCommunVue=new CommunVue();this.etapeValider=0;this.construct=function(b,c){var a=this;this.idCommande=b;this.idAdherent=c;$.post("./index.php?m=GestionCommande&v=MarcheCommande","id_commande="+b+"&id_adherent="+c,function(f){Infobulle.init();if(f.valid){a.idCompte=f.adherent.adhIdCompte;for(lLigne in f.commande){var e=new Object();e.quantite=f.commande[lLigne].dcomTaille;e.prix=f.commande[lLigne].dcomPrix;if(!a.listeLot[f.commande[lLigne].proId]){if(!isArray(a.listeLot[f.commande[lLigne].proId])){a.listeLot[f.commande[lLigne].proId]=new Array()}}a.listeLot[f.commande[lLigne].proId].push(e)}var d=new Array();for(lIndice in f.typePaiement){d[f.typePaiement[lIndice].id]=f.typePaiement[lIndice]}a.typePaiement=d;a.solde=parseFloat(f.adherent.opeMontant);a.afficher(f)}else{Infobulle.generer(f,"")}},"json")};this.afficher=function(c){Infobulle.init();if(c.valid){var d=this;var a=new GestionCommandeTemplate();var f=a.achatCommandePage;var b=new Object();b.comNumero=c.commande[0].comNumero;b.adhNumero=c.adherent.adhNumero;b.adhCompte=c.adherent.cptLabel;b.adhNom=c.adherent.adhNom;b.adhPrenom=c.adherent.adhPrenom;b.sigleMonetaire=gSigleMonetaire;b.total=0;b.produits=new Array();lListeIdProduit=new Array();for(lLigne in c.commande){lPush=true;for(lId in lListeIdProduit){if(lListeIdProduit[lId]==c.commande[lLigne].proId){lPush=false}}if(lPush){lListeIdProduit.push(c.commande[lLigne].proId);var g=new Object();g.proId=c.commande[lLigne].proId;g.nproNom=c.commande[lLigne].nproNom;g.proUniteMesure=c.commande[lLigne].proUniteMesure;g.stoQuantite=0;g.proPrix=0;var e=0;for(lReservation in c.reservation){if(c.reservation[lReservation].proId==g.proId){g.stoQuantite=c.reservation[lReservation].stoQuantite*-1;e=this.calculPrixProduit(g.proId,g.stoQuantite);g.proPrix=e.nombreFormate(2,","," ")}}b.total+=e;b.produits.push(g)}}b.adhSolde=parseFloat(c.adherent.opeMontant);b.adhNouveauSolde=b.adhSolde-b.total;b.adhSolde=b.adhSolde.nombreFormate(2,","," ");b.adhNouveauSolde=b.adhNouveauSolde.nombreFormate(2,","," ");b.total=b.total.nombreFormate(2,","," ");b.typePaiement=c.typePaiement;$("#contenu").replaceWith(d.affect($(f.template(b))));d.changerTypePaiement($(":input[name=typepaiement]"));d.majNouveauSolde()}else{Infobulle.generer(c,"")}};this.affect=function(a){a=this.affectSelectTypePaiement(a);a=this.affectNouveauSolde(a);a=this.mCommunVue.comNumeric(a);a=this.affectNouveauPrixProduit(a);a=this.affectChampComplementaire(a);a=this.affectValider(a);a=this.affectAnnuler(a);a=this.affectModifier(a);return a};this.affectSelectTypePaiement=function(a){var b=this;a.find(":input[name=typepaiement]").change(function(){b.changerTypePaiement($(this))});return a};this.affectNouveauSolde=function(a){var b=this;a.find(":input[name=montant-rechargement], .produit-prix").keyup(function(){b.majNouveauSolde();b.controlerAchat()});return a};this.affectNouveauPrixProduit=function(a){var b=this;a.find(".produit-quantite").keyup(function(){b.majPrixProduit($(this));b.controlerAchat()});return a};this.affectChampComplementaire=function(a){var b=this;a.find(":input[name=champ-complementaire]").keyup(function(){b.controlerAchat()});return a};this.affectValider=function(a){var b=this;a.find("#btn-valider").click(function(){b.creerRecapitulatif()});return a};this.affectAnnuler=function(a){var b=this;a.find("#btn-annuler").click(function(){b.retourListe()});return a};this.affectModifier=function(a){var b=this;a.find("#btn-modifier").click(function(){b.boutonModifier()});return a};this.majPrixProduit=function(a){var e=parseFloat(a.val().numberFrToDb());if(isNaN(e)){e=0}var b=a.parent().parent();var c=b.find(".produit-id").text();var d=this.calculPrixProduit(c,e);if(isNaN(d)){d=0}b.find(".produit-prix").val(d.nombreFormate(2,","," "));this.majNouveauSolde()};this.controlerAchat=function(){Infobulle.init();var a=new AchatCommandeValid();var b=a.validAjout(this.getAchatCommandeVO());Infobulle.generer(b,"");return b};this.calculPrixProduit=function(a,d){if(this.listeLot[a]){var b=this.listeLot[a];var c=0;for(lLot in b){if(d%b[lLot].quantite==0){c=(d/b[lLot].quantite)*b[lLot].prix}}return c}return 0};this.majTotal=function(){var a=this;$("#total-achat").text(a.calculerTotal().nombreFormate(2,","," "))};this.calculerTotal=function(){var a=0;$(".produit-prix").each(function(){var b=parseFloat($(this).val().numberFrToDb());if(isNaN(b)){b=0}a+=b});return a};this.majNouveauSolde=function(){this.majTotal();var a=this.calculNouveauSolde();if(a<=0){$("#nouveau-solde").addClass("com-nombre-negatif");$("#nouveau-solde-sigle").addClass("com-nombre-negatif")}else{$("#nouveau-solde").removeClass("com-nombre-negatif");$("#nouveau-solde-sigle").removeClass("com-nombre-negatif")}$("#nouveau-solde").text(a.nombreFormate(2,","," "))};this.calculNouveauSolde=function(){var b=parseFloat($("#total-achat").text().numberFrToDb());if(isNaN(b)){b=0}var a=parseFloat($(":input[name=montant-rechargement]").val().numberFrToDb());if(isNaN(a)){a=0}return this.solde-b+a};this.changerTypePaiement=function(c){var b=c.val();var a=this.getLabelChamComplementaire(b);if(a!=null){$("#label-champ-complementaire").text(a).show();$("#td-champ-complementaire").show()}else{$("#label-champ-complementaire").text("").hide();$(":input[name=champ-complementaire]").val();$("#td-champ-complementaire").hide()}};this.getLabelChamComplementaire=function(b){var a=this.typePaiement;if(a[b]){if(a[b].champComplementaire==1){return a[b].labelChampComplementaire}}return null};this.getAchatCommandeVO=function(){var a=new AchatCommandeVO();a.id=this.idCommande;a.idCompte=this.idCompte;a.produits=this.getProduitsVO();a.rechargement=this.getRechargementVO();return a};this.getProduitsVO=function(){var a=new Array();$(".ligne-produit").each(function(){var c=new ProduitAchatVO();c.id=$(this).find(".produit-id").text();var d=$(this).find(".produit-quantite").val().numberFrToDb();if(!isNaN(d)&&!d.isEmpty()){d=parseFloat(d)}c.quantite=d;var b=$(this).find(".produit-prix").val().numberFrToDb();if(!isNaN(b)&&!b.isEmpty()){b=parseFloat(b)}c.prix=b;a.push(c)});return a};this.getRechargementVO=function(){var a=new RechargementCompteVO();a.id=this.idCompte;var b=$(":input[name=montant-rechargement]").val().numberFrToDb();if(!isNaN(b)&&!b.isEmpty()){b=parseFloat(b)}a.montant=b;a.typePaiement=$(":input[name=typepaiement]").val();if(this.getLabelChamComplementaire(a.typePaiement)!=null){a.champComplementaireObligatoire=1;a.champComplementaire=$(":input[name=champ-complementaire]").val()}else{a.champComplementaireObligatoire=0}return a};this.creerRecapitulatif=function(){var a=this.controlerAchat();if(a.valid){if(this.etapeValider==0){$(".produit-quantite,#rechargementchampComplementaire,#typepaiement").each(function(){$(this).inputToText()});$(".produit-prix,#rechargementmontant").each(function(){$(this).inputToText("montant")});$("#btn-modifier").show();$("#btn-annuler").hide();this.etapeValider=1}else{if(this.etapeValider==1){this.enregistrerAchat()}}}};this.enregistrerAchat=function(){var b=this;var a=this.getAchatCommandeVO();$.post("./index.php?m=GestionCommande&v=MarcheCommande","achat="+$.toJSON(a),function(d){if(d.valid){var c=new GestionCommandeTemplate();var e=c.achatCommandeSucces;$("#contenu").replaceWith(b.affectAnnuler($(e)))}else{b.boutonModifier();Infobulle.generer(d,"")}b.etapeValider=0},"json")};this.boutonModifier=function(){if(this.etapeValider==1){$(".produit-prix,#rechargementmontant,.produit-quantite,#rechargementchampComplementaire,#typepaiement").each(function(){$(this).textToInput()});$("#btn-modifier").hide();$("#btn-annuler").show();this.etapeValider=0}};this.retourListe=function(){var a=new MarcheCommandeVue();a.construct(this.idCommande)}}function MarcheCommandeVue(){this.idCommande=null;this.construct=function(a){var b=this;$.post("./index.php?m=GestionCommande&v=MarcheCommande","id_commande="+a,function(c){Infobulle.init();if(c.valid){b.afficher(c)}else{Infobulle.generer(c,"")}},"json");this.idCommande=a};this.afficher=function(c){Infobulle.init();if(c.valid){if(c.listeAdherentCommande){var d=this;var a=new GestionCommandeTemplate();var e=a.listeAdherentCommandePage;c.comNumero=c.listeAdherentCommande[0].comNumero;$("#contenu").replaceWith(d.affect($(e.template(c))))}else{var f=new TemplateVR();f.valid=false;f.log.valid=false;var b=new VRerreur();b.code=ERR_211_CODE;b.message=ERR_211_MSG;f.log.push(b);Infobulle.generer(f,"")}}else{Infobulle.generer(c,"")}};this.affect=function(a){a=this.affectTri(a);a=this.affectRecherche(a);a=this.affectLienAchat(a);return a};this.affectTri=function(a){a.find(".com-table").tablesorter({sortList:[[2,0]]});return a};this.affectRecherche=function(a){a.find("#filter").keyup(function(){$.uiTableFilter($(".com-table"),this.value)});return a};this.affectLienAchat=function(a){var b=this;a.find(".achat-commande-ligne").click(function(){var c=new AchatCommandeVue();c.construct(b.idCommande,$(this).find(".id-adherent").text())});return a}}function ReservationAdherentVue(a){this.mAdherent=null;this.infoCommande=new Object();this.pdtCommande=new Array();this.reservation=new Array();this.reservationModif=new Array();this.construct=function(b){var c=this;$.post("./index.php?m=GestionCommande&v=ReservationAdherent","pParam="+$.toJSON(b),function(d){Infobulle.init();if(d.valid){c.mAdherent=d.adherent;c.infoCommande.comId=d.commande[0].comId;c.infoCommande.comNumero=d.commande[0].comNumero;c.infoCommande.comNom=d.commande[0].comNom;c.infoCommande.comDescription=d.commande[0].comDescription;c.infoCommande.dateTimeFinReservation=d.commande[0].comDateFinReservation;c.infoCommande.dateFinReservation=d.commande[0].comDateFinReservation.extractDbDate().dateDbToFr();c.infoCommande.heureFinReservation=d.commande[0].comDateFinReservation.extractDbHeure();c.infoCommande.minuteFinReservation=d.commande[0].comDateFinReservation.extractDbMinute();c.infoCommande.dateMarcheDebut=d.commande[0].comDateMarcheDebut.extractDbDate().dateDbToFr();c.infoCommande.heureMarcheDebut=d.commande[0].comDateMarcheDebut.extractDbHeure();c.infoCommande.minuteMarcheDebut=d.commande[0].comDateMarcheDebut.extractDbMinute();c.infoCommande.heureMarcheFin=d.commande[0].comDateMarcheFin.extractDbHeure();c.infoCommande.minuteMarcheFin=d.commande[0].comDateMarcheFin.extractDbMinute();c.infoCommande.comArchive=d.commande[0].comArchive;$(d.commande).each(function(){var f=new Object();f.dcomId=this.dcomId;f.dcomIdProduit=this.dcomIdProduit;f.dcomTaille=this.dcomTaille;f.dcomPrix=this.dcomPrix;if(c.pdtCommande[this.proId]){c.pdtCommande[this.proId].lot[f.dcomId]=f}else{var e=new Object();e.proId=this.proId;e.proUniteMesure=this.proUniteMesure;e.proMaxProduitCommande=this.proMaxProduitCommande;$(d.stock).each(function(){if(this.proId==e.proId){if(this.stoQuantite<e.proMaxProduitCommande){e.proMaxProduitCommande=this.stoQuantite}}});e.nproNom=this.nproNom;e.nproDescription=this.nproDescription;e.nproIdCategorie=this.nproIdCategorie;e.lot=new Array();e.lot[f.dcomId]=f;c.pdtCommande[e.proId]=e}});$(d.reservation).each(function(){this.stoQuantite=this.stoQuantite*-1;c.reservation[this.proId]=this});c.afficher()}else{Infobulle.generer(d,"")}},"json")};this.afficher=function(){this.afficherDetailReservation()};this.afficherDetailReservation=function(){var e=this;var b=new GestionCommandeTemplate();var f=b.detailReservation;var c={};c.adhId=this.mAdherent.adhId;c.adhNumero=this.mAdherent.adhNumero;c.adhCompte=this.mAdherent.cptLabel;c.adhNom=this.mAdherent.adhNom;c.adhPrenom=this.mAdherent.adhPrenom;c.adhSolde=this.mAdherent.opeMontant.nombreFormate(2,","," ");c.sigleMonetaire=gSigleMonetaire;c.comNumero=this.infoCommande.comNumero;c.dateFinReservation=this.infoCommande.dateFinReservation;c.heureFinReservation=this.infoCommande.heureFinReservation;c.minuteFinReservation=this.infoCommande.minuteFinReservation;c.dateMarcheDebut=this.infoCommande.dateMarcheDebut;c.heureMarcheDebut=this.infoCommande.heureMarcheDebut;c.minuteMarcheDebut=this.infoCommande.minuteMarcheDebut;c.heureMarcheFin=this.infoCommande.heureMarcheFin;c.minuteMarcheFin=this.infoCommande.minuteMarcheFin;c.reservation=new Array();var d=0;$(this.pdtCommande).each(function(){if(e.reservation[this.proId]){var g=new Object;g.nproNom=this.nproNom;g.stoQuantite=parseFloat(e.reservation[this.proId].stoQuantite);g.proUniteMesure=this.proUniteMesure;g.prix=0;$(this.lot).each(function(){if(g.stoQuantite%this.dcomTaille==0){g.prix=(g.stoQuantite/this.dcomTaille)*this.dcomPrix}});d+=g.prix;g.stoQuantite=g.stoQuantite.nombreFormate(2,","," ");g.prix=g.prix.nombreFormate(2,","," ");c.reservation.push(g)}});c.total=parseFloat(d).nombreFormate(2,","," ");$("#contenu").replaceWith(e.affect($(f.template(c))))};this.afficherModifier=function(){var e=this;var b=new GestionCommandeTemplate();var f=b.modifierReservation;var c={};c.adhId=this.mAdherent.adhId;c.adhNumero=this.mAdherent.adhNumero;c.adhCompte=this.mAdherent.cptLabel;c.adhNom=this.mAdherent.adhNom;c.adhPrenom=this.mAdherent.adhPrenom;c.adhSolde=this.mAdherent.opeMontant.nombreFormate(2,","," ");c.adhNouveauSolde=0;c.sigleMonetaire=gSigleMonetaire;c.comNumero=this.infoCommande.comNumero;c.dateFinReservation=this.infoCommande.dateFinReservation;c.heureFinReservation=this.infoCommande.heureFinReservation;c.minuteFinReservation=this.infoCommande.minuteFinReservation;c.dateMarcheDebut=this.infoCommande.dateMarcheDebut;c.heureMarcheDebut=this.infoCommande.heureMarcheDebut;c.minuteMarcheDebut=this.infoCommande.minuteMarcheDebut;c.heureMarcheFin=this.infoCommande.heureMarcheFin;c.minuteMarcheFin=this.infoCommande.minuteMarcheFin;c.produit=new Array();var d=0;$(this.pdtCommande).each(function(){if(this.proId){var g={};g.proId=this.proId;g.nproNom=this.nproNom;g.proMaxProduitCommande=parseFloat(this.proMaxProduitCommande).nombreFormate(2,","," ");g.proUniteMesure=this.proUniteMesure;g.lot=new Array();var j=0;var h=-1;var k=-1;$(this.lot).each(function(){if(this.dcomId){var l={};l.dcomId=this.dcomId;l.dcomTaille=parseFloat(this.dcomTaille).nombreFormate(2,","," ");l.dcomPrix=parseFloat(this.dcomPrix).nombreFormate(2,","," ");l.prixReservation=parseFloat(this.dcomPrix);l.stoQuantiteReservation=parseFloat(this.dcomTaille);if(e.reservation[g.proId]&&(e.reservation[g.proId].stoQuantite%this.dcomTaille==0)){l.stoQuantiteReservation=parseFloat(e.reservation[g.proId].stoQuantite);l.prixReservation=(l.stoQuantiteReservation/this.dcomTaille)*this.dcomPrix;d+=l.prixReservation;h=this.dcomId;l.checked='checked="checked"'}l.stoQuantiteReservation=l.stoQuantiteReservation.nombreFormate(2,","," ");l.prixReservation=l.prixReservation.nombreFormate(2,","," ");g.lot.push(l)}});c.total=parseFloat(d).nombreFormate(2,","," ");if(h!=-1){g.checked='checked="checked"'}else{if(g.lot[0]){g.lot[0].checked='checked="checked"'}}c.produit.push(g)}});this.reservationModif=new Array();$(this.reservation).each(function(){if(this.proId){e.reservationModif[this.proId]={comId:this.comId,proId:this.proId,stoId:this.stoId,stoQuantite:this.stoQuantite,stoType:this.stoType,stoIdCompte:this.stoIdCompte}}});$("#contenu").replaceWith(e.affectModifier($(f.template(c))))};this.affect=function(b){b=this.affectDroitEdition(b);b=this.affectModifierReservation(b);b=this.affectAnnulerDetailReservation(b);return b};this.affectDroitEdition=function(b){if(!dateTimeEstPLusGrandeEgale(this.infoCommande.dateTimeFinReservation,getDateTimeAujourdhuiDb(),"db")){b.find(".boutons-edition").hide()}return b};this.affectModifier=function(b){b=this.affectBtnQte(b);b=this.affectChangementLot(b);b=this.affectChangementProduit(b);b=this.preparerAffichageModifier(b);b=this.affectValiderReservation(b);b=this.affectAnnulerReservation(b);b=this.affectNouveauSolde(b);return b};this.affectBtnQte=function(b){var c=this;b.find(".btn-plus").click(function(){c.nouvelleQuantite($(this).parent().parent().find(".pdt-id").text(),$(this).parent().parent().find(".lot-id").text(),1)});b.find(".btn-moins").click(function(){c.nouvelleQuantite($(this).parent().parent().find(".pdt-id").text(),$(this).parent().parent().find(".lot-id").text(),-1)});return b};this.affectChangementLot=function(b){var c=this;b.find(".lot").click(function(){$(this).find(":radio").attr("checked","checked");c.changerLot($(this).find(".pdt-id").text(),$(this).find(".lot-id").text())});return b};this.affectChangementProduit=function(b){var c=this;b.find(".pdt :checkbox").click(function(){c.changerProduit($(this).parent().parent().find(".pdt-id").text())});return b};this.affectValiderReservation=function(b){var c=this;b.find("#btn-valider").click(function(){c.validerReservation()});return b};this.affectAnnulerReservation=function(b){var c=this;b.find("#btn-annuler").click(function(){c.afficherDetailReservation()});return b};this.affectModifierReservation=function(b){var c=this;b.find("#btn-modifier").click(function(){c.afficherModifier()});return b};this.affectAnnulerDetailReservation=function(b){var c=this;b.find("#btn-annuler").click(function(){EditerCommandeVue({id_commande:c.infoCommande.comId})});return b};this.nouvelleQuantite=function(f,j,b){var g=this.pdtCommande[f].proMaxProduitCommande;var k=this.pdtCommande[f].lot[j].dcomTaille;var h=this.pdtCommande[f].lot[j].dcomPrix;var d=0;if(this.reservationModif[f]&&(this.reservationModif[f].stoQuantite%k==0)){d=this.reservationModif[f].stoQuantite/k}d+=b;var c=0;c=d*k;if(c>0&&c<=g){var e=0;e=d*h;this.reservationModif[f].stoQuantite=c;$("#qte-pdt-"+f+"-lot-"+j).text(parseFloat(c).nombreFormate(2,","," "));$("#prix-pdt-"+f+"-lot-"+j).text(parseFloat(e).nombreFormate(2,","," "));this.majTotal()}};this.changerLot=function(b,c){$(".btn-pdt-"+b).attr("disabled","disabled").addClass("ui-helper-hidden");$(".colonne-pdt-"+b).addClass("ui-helper-hidden");$("#btn-moins-lot-"+c+",#btn-plus-lot-"+c).removeAttr("disabled").removeClass("ui-helper-hidden");$("#colonne-qte-pdt-"+b+"-lot-"+c+",#colonne-prix-pdt-"+b+"-lot-"+c+",#colonne-sigle-pdt-"+b+"-lot-"+c).removeClass("ui-helper-hidden");this.reservationModif[b].stoQuantite=$("#qte-pdt-"+b+"-lot-"+c).text().numberFrToDb();this.majTotal()};this.changerProduit=function(b){var c=this;if($("#pdt-"+b).find(":checkbox").attr("checked")){$(".lot-pdt-"+b).show();$("[name=lot-produit-"+b+"]").each(function(){if($(this).attr("checked")){var e=$("#qte-pdt-"+b+"-lot-"+$(this).parent().parent().find(".lot-id").text()).text().numberFrToDb();if(c.reservationModif[b]){c.reservationModif[b].stoQuantite=e}else{var d={};d.comId=c.infoCommande.comId;d.proId=b;d.stoQuantite=e;c.reservationModif[b]=d}}})}else{$(".lot-pdt-"+b).hide();if(this.reservationModif[b]){this.reservationModif[b]=null}}this.majTotal()};this.majTotal=function(){$("#total").text(this.calculTotal().nombreFormate(2,","," "));this.majNouveauSolde()};this.majNouveauSolde=function(){var b=this.mAdherent.opeMontant-this.calculTotal();if(b<=0){$("#nouveau-solde").addClass("com-nombre-negatif");$("#nouveau-solde-sigle").addClass("com-nombre-negatif")}else{$("#nouveau-solde").removeClass("com-nombre-negatif");$("#nouveau-solde-sigle").removeClass("com-nombre-negatif")}$("#nouveau-solde").text(b.nombreFormate(2,","," "))};this.affectNouveauSolde=function(c){var b=this.mAdherent.opeMontant-this.calculTotal();if(b<=0){c.find("#nouveau-solde").addClass("com-nombre-negatif");c.find("#nouveau-solde-sigle").addClass("com-nombre-negatif")}else{c.find("#nouveau-solde").removeClass("com-nombre-negatif");c.find("#nouveau-solde-sigle").removeClass("com-nombre-negatif")}c.find("#nouveau-solde").text(b.nombreFormate(2,","," "));return c};this.calculTotal=function(){var c=this;var b=0;$(this.reservationModif).each(function(){var d=this;if(d.stoQuantite){if(c.pdtCommande[d.proId]){$(c.pdtCommande[d.proId].lot).each(function(){if(d.stoQuantite%this.dcomTaille==0){b+=(d.stoQuantite/this.dcomTaille)*this.dcomPrix}})}}});return b};this.preparerAffichageModifier=function(b){var c=this;b.find(":checkbox:not(:checked)").each(function(){b.find(".lot-pdt-"+$(this).parent().parent().find(".pdt-id").text()).hide()});b.find(":radio:not(:checked)").each(function(){var e=$(this).parent().parent().find(".lot-id").text();var d=$(this).parent().parent().find(".pdt-id").text();b.find("#btn-moins-lot-"+e+",#btn-plus-lot-"+e).attr("disabled","disabled").addClass("ui-helper-hidden");b.find("#colonne-qte-pdt-"+d+"-lot-"+e+",#colonne-prix-pdt-"+d+"-lot-"+e+",#colonne-sigle-pdt-"+d+"-lot-"+e).addClass("ui-helper-hidden")});return b};this.validerReservation=function(){var e=this;Infobulle.init();var c=new ListeReservationCommandeVO();var f=0;$(this.reservationModif).each(function(){if(this.stoQuantite){var h=new ReservationCommandeVO();h.id="";h.stoQuantite=this.stoQuantite*-1;h.stoIdProduit=this.proId;c.commandes.push(h);f++}});if(f>0){var d=new ListeReservationCommandeValid();var g=d.validAjout(c);if(!g.valid){Infobulle.generer(g,"")}else{lParam={reservation:c,id_compte:this.mAdherent.adhIdCompte};$.post("./index.php?m=GestionCommande&v=ReservationAdherent","pParam="+$.toJSON(lParam),function(h){Infobulle.init();if(h.valid){e.reservation=new Array();$(e.reservationModif).each(function(){if(this.proId){e.reservation[this.proId]={comId:this.comId,proId:this.proId,stoId:this.stoId,stoQuantite:this.stoQuantite,stoType:this.stoType,stoIdCompte:this.stoIdCompte}}});e.afficher()}else{Infobulle.generer(h,"")}},"json")}}else{var g=new TemplateVR();g.valid=false;g.log.valid=false;var b=new VRerreur();b.code=ERR_207_CODE;b.message=ERR_207_MSG;g.log.erreurs.push(b);Infobulle.generer(g,"")}};this.construct(a)}function EditerCommandeVue(a){this.mNiveau=[];this.mIdCommande=null;this.construct=function(b){var c=this;$.post("./index.php?m=GestionCommande&v=EditerCommande","pParam="+$.toJSON(b),function(d){Infobulle.init();if(d.valid){c.afficher(d)}else{Infobulle.generer(d,"")}},"json")};this.afficher=function(d){var e=this;var b=new GestionCommandeTemplate();var f=b.editerCommandePage;var c={};c.comId=d.commande[0].comId;this.mIdCommande=c.comId;c.comNumero=d.commande[0].comNumero;c.comDescription=d.commande[0].comDescription;c.dateTimeFinReservation=d.commande[0].comDateFinReservation;c.dateFinReservation=d.commande[0].comDateFinReservation.extractDbDate().dateDbToFr();c.heureFinReservation=d.commande[0].comDateFinReservation.extractDbHeure();c.minuteFinReservation=d.commande[0].comDateFinReservation.extractDbMinute();c.dateMarcheDebut=d.commande[0].comDateMarcheDebut.extractDbDate().dateDbToFr();c.heureMarcheDebut=d.commande[0].comDateMarcheDebut.extractDbHeure();c.minuteMarcheDebut=d.commande[0].comDateMarcheDebut.extractDbMinute();c.heureMarcheFin=d.commande[0].comDateMarcheFin.extractDbHeure();c.minuteMarcheFin=d.commande[0].comDateMarcheFin.extractDbMinute();c.pdtCommande=[];$(d.commande).each(function(){var g={dcomTaille:this.dcomTaille.nombreFormate(2,","," "),dcomPrix:this.dcomPrix.nombreFormate(2,","," ")};if(c.pdtCommande[this.proId]){c.pdtCommande[this.proId].lot[this.dcomId]=g}else{var h={proId:this.proId,proUniteMesure:this.proUniteMesure,proMaxProduitCommande:this.proMaxProduitCommande.nombreFormate(2,","," "),nproNom:this.nproNom,lot:[]};h.lot[this.dcomId]=g;$(d.stockInitiaux).each(function(){if(this.idProduit==h.proId){h.quantiteInit=this.quantite}});$(d.stock).each(function(){if(this.proId==h.proId){h.quantite=this.stoQuantite}});h.quantiteCommande=h.quantiteInit-h.quantite;e.mNiveau.push({id:h.proId,quantite:parseInt(h.quantiteCommande*100/h.quantiteInit)});h.quantiteCommande=h.quantiteCommande.nombreFormate(2,","," ");h.quantiteInit=h.quantiteInit.nombreFormate(2,","," ");h.quantite=h.quantite.nombreFormate(2,","," ");c.pdtCommande[this.proId]=h}});c.listeAdherentCommande=d.listeAdherentCommande;c.sigleMonetaire=gSigleMonetaire;$("#contenu").replaceWith(e.affect($(f.template(c))))};this.affect=function(b){b=this.affectTri(b);b=this.affectRecherche(b);b=this.affectNiveau(b);b=this.affectReservation(b);return b};this.affectTri=function(b){b.find(".com-table").tablesorter({sortList:[[2,0]]});return b};this.affectRecherche=function(b){b.find("#filter").keyup(function(){$.uiTableFilter($(".com-table"),this.value)});return b};this.affectNiveau=function(b){$(this.mNiveau).each(function(){var c=this.id;var d=this.quantite;b.find("#pdt-"+c).progressbar({value:d});b.find(".pdt-"+c+"-afficher-detail").click(function(){b.find("#pdt-"+c+"-detail").slideToggle()})});return b};this.affectReservation=function(b){var c=this;b.find(".edt-com-reservation-ligne").click(function(){ReservationAdherentVue({id_commande:c.mIdCommande,id_adherent:$(this).find(".id-adherent").text()})});return b};this.construct(a)}function AfficherReservationVue(a){this.infoCommande=new Object();this.pdtCommande=new Array();this.reservation=new Array();this.reservationModif=new Array();this.construct=function(c){var b=this;$.post("./index.php?m=MonCompte&v=AfficherReservation","id_commande="+c,function(d){Infobulle.init();if(d.valid){b.infoCommande.comId=d.commande[0].comId;b.infoCommande.comNumero=d.commande[0].comNumero;b.infoCommande.comNom=d.commande[0].comNom;b.infoCommande.comDescription=d.commande[0].comDescription;b.infoCommande.dateTimeFinReservation=d.commande[0].comDateFinReservation;b.infoCommande.dateFinReservation=d.commande[0].comDateFinReservation.extractDbDate().dateDbToFr();b.infoCommande.heureFinReservation=d.commande[0].comDateFinReservation.extractDbHeure();b.infoCommande.minuteFinReservation=d.commande[0].comDateFinReservation.extractDbMinute();b.infoCommande.dateMarcheDebut=d.commande[0].comDateMarcheDebut.extractDbDate().dateDbToFr();b.infoCommande.heureMarcheDebut=d.commande[0].comDateMarcheDebut.extractDbHeure();b.infoCommande.minuteMarcheDebut=d.commande[0].comDateMarcheDebut.extractDbMinute();b.infoCommande.heureMarcheFin=d.commande[0].comDateMarcheFin.extractDbHeure();b.infoCommande.minuteMarcheFin=d.commande[0].comDateMarcheFin.extractDbMinute();b.infoCommande.comArchive=d.commande[0].comArchive;$(d.commande).each(function(){var f=new Object();f.dcomId=this.dcomId;f.dcomIdProduit=this.dcomIdProduit;f.dcomTaille=this.dcomTaille;f.dcomPrix=this.dcomPrix;if(b.pdtCommande[this.proId]){b.pdtCommande[this.proId].lot[f.dcomId]=f}else{var e=new Object();e.proId=this.proId;e.proUniteMesure=this.proUniteMesure;e.proMaxProduitCommande=this.proMaxProduitCommande;$(d.stock).each(function(){if(this.proId==e.proId){if(this.stoQuantite<e.proMaxProduitCommande){e.proMaxProduitCommande=this.stoQuantite}}});e.nproNom=this.nproNom;e.nproDescription=this.nproDescription;e.nproIdCategorie=this.nproIdCategorie;e.lot=new Array();e.lot[f.dcomId]=f;b.pdtCommande[e.proId]=e}});$(d.reservation).each(function(){this.stoQuantite=this.stoQuantite*-1;b.reservation[this.proId]=this});b.afficher()}else{Infobulle.generer(d,"")}},"json")};this.afficher=function(){this.afficherDetailReservation()};this.afficherDetailReservation=function(){var e=this;var b=new MonCompteTemplate();var f=b.detailReservation;var c=new Object();c.sigleMonetaire=gSigleMonetaire;c.comNumero=this.infoCommande.comNumero;c.dateFinReservation=this.infoCommande.dateFinReservation;c.heureFinReservation=this.infoCommande.heureFinReservation;c.minuteFinReservation=this.infoCommande.minuteFinReservation;c.dateMarcheDebut=this.infoCommande.dateMarcheDebut;c.heureMarcheDebut=this.infoCommande.heureMarcheDebut;c.minuteMarcheDebut=this.infoCommande.minuteMarcheDebut;c.heureMarcheFin=this.infoCommande.heureMarcheFin;c.minuteMarcheFin=this.infoCommande.minuteMarcheFin;c.reservation=new Array();var d=0;$(this.pdtCommande).each(function(){if(e.reservation[this.proId]){var g=new Object;g.nproNom=this.nproNom;g.stoQuantite=parseFloat(e.reservation[this.proId].stoQuantite);g.proUniteMesure=this.proUniteMesure;g.prix=0;$(this.lot).each(function(){if(g.stoQuantite%this.dcomTaille==0){g.prix=(g.stoQuantite/this.dcomTaille)*this.dcomPrix}});d+=g.prix;g.stoQuantite=g.stoQuantite.nombreFormate(2,","," ");g.prix=g.prix.nombreFormate(2,","," ");c.reservation.push(g)}});c.total=parseFloat(d).nombreFormate(2,","," ");$("#contenu").replaceWith(e.affect($(f.template(c))))};this.afficherModifier=function(){var e=this;var b=new MonCompteTemplate();var f=b.modifierReservation;var c={};c.sigleMonetaire=gSigleMonetaire;c.comNumero=this.infoCommande.comNumero;c.dateFinReservation=this.infoCommande.dateFinReservation;c.heureFinReservation=this.infoCommande.heureFinReservation;c.minuteFinReservation=this.infoCommande.minuteFinReservation;c.dateMarcheDebut=this.infoCommande.dateMarcheDebut;c.heureMarcheDebut=this.infoCommande.heureMarcheDebut;c.minuteMarcheDebut=this.infoCommande.minuteMarcheDebut;c.heureMarcheFin=this.infoCommande.heureMarcheFin;c.minuteMarcheFin=this.infoCommande.minuteMarcheFin;c.produit=new Array();var d=0;$(this.pdtCommande).each(function(){if(this.proId){var g={};g.proId=this.proId;g.nproNom=this.nproNom;g.proMaxProduitCommande=parseFloat(this.proMaxProduitCommande).nombreFormate(2,","," ");g.proUniteMesure=this.proUniteMesure;g.lot=new Array();var j=0;var h=-1;var k=-1;$(this.lot).each(function(){if(this.dcomId){var l={};l.dcomId=this.dcomId;l.dcomTaille=parseFloat(this.dcomTaille).nombreFormate(2,","," ");l.dcomPrix=parseFloat(this.dcomPrix).nombreFormate(2,","," ");l.prixReservation=parseFloat(this.dcomPrix);l.stoQuantiteReservation=parseFloat(this.dcomTaille);if(e.reservation[g.proId]&&(e.reservation[g.proId].stoQuantite%this.dcomTaille==0)){l.stoQuantiteReservation=parseFloat(e.reservation[g.proId].stoQuantite);l.prixReservation=(l.stoQuantiteReservation/this.dcomTaille)*this.dcomPrix;d+=l.prixReservation;h=this.dcomId;l.checked='checked="checked"'}l.stoQuantiteReservation=l.stoQuantiteReservation.nombreFormate(2,","," ");l.prixReservation=l.prixReservation.nombreFormate(2,","," ");g.lot.push(l)}});c.total=parseFloat(d).nombreFormate(2,","," ");if(h!=-1){g.checked='checked="checked"'}else{if(g.lot[0]){g.lot[0].checked='checked="checked"'}}c.produit.push(g)}});this.reservationModif=new Array();$(this.reservation).each(function(){if(this.proId){e.reservationModif[this.proId]={comId:this.comId,proId:this.proId,stoId:this.stoId,stoQuantite:this.stoQuantite,stoType:this.stoType,stoIdCompte:this.stoIdCompte}}});$("#contenu").replaceWith(e.affectModifier($(f.template(c))))};this.affect=function(b){b=this.affectDroitEdition(b);b=this.affectModifierReservation(b);return b};this.affectDroitEdition=function(b){if(!dateTimeEstPLusGrandeEgale(this.infoCommande.dateTimeFinReservation,getDateTimeAujourdhuiDb(),"db")){b.find(".boutons-edition").hide()}return b};this.affectModifier=function(b){b=this.affectBtnQte(b);b=this.affectChangementLot(b);b=this.affectChangementProduit(b);b=this.preparerAffichageModifier(b);b=this.affectValiderReservation(b);b=this.affectAnnulerReservation(b);return b};this.affectBtnQte=function(b){var c=this;b.find(".btn-plus").click(function(){c.nouvelleQuantite($(this).parent().parent().find(".pdt-id").text(),$(this).parent().parent().find(".lot-id").text(),1)});b.find(".btn-moins").click(function(){c.nouvelleQuantite($(this).parent().parent().find(".pdt-id").text(),$(this).parent().parent().find(".lot-id").text(),-1)});return b};this.affectChangementLot=function(b){var c=this;b.find(".lot").click(function(){$(this).find(":radio").attr("checked","checked");c.changerLot($(this).find(".pdt-id").text(),$(this).find(".lot-id").text())});return b};this.affectChangementProduit=function(b){var c=this;b.find(".pdt :checkbox").click(function(){c.changerProduit($(this).parent().parent().find(".pdt-id").text())});return b};this.affectValiderReservation=function(b){var c=this;b.find("#btn-valider").click(function(){c.validerReservation()});return b};this.affectAnnulerReservation=function(b){var c=this;b.find("#btn-annuler").click(function(){c.afficherDetailReservation()});return b};this.affectModifierReservation=function(b){var c=this;b.find("#btn-modifier").click(function(){c.afficherModifier()});return b};this.nouvelleQuantite=function(f,j,b){var g=this.pdtCommande[f].proMaxProduitCommande;var k=this.pdtCommande[f].lot[j].dcomTaille;var h=this.pdtCommande[f].lot[j].dcomPrix;var d=0;if(this.reservationModif[f]&&(this.reservationModif[f].stoQuantite%k==0)){d=this.reservationModif[f].stoQuantite/k}d+=b;var c=0;c=d*k;if(c>0&&c<=g){var e=0;e=d*h;this.reservationModif[f].stoQuantite=c;$("#qte-pdt-"+f+"-lot-"+j).text(parseFloat(c).nombreFormate(2,","," "));$("#prix-pdt-"+f+"-lot-"+j).text(parseFloat(e).nombreFormate(2,","," "));this.majTotal()}};this.changerLot=function(b,c){$(".btn-pdt-"+b).attr("disabled","disabled").addClass("ui-helper-hidden");$(".colonne-pdt-"+b).addClass("ui-helper-hidden");$("#btn-moins-lot-"+c+",#btn-plus-lot-"+c).removeAttr("disabled").removeClass("ui-helper-hidden");$("#colonne-qte-pdt-"+b+"-lot-"+c+",#colonne-prix-pdt-"+b+"-lot-"+c+",#colonne-sigle-pdt-"+b+"-lot-"+c).removeClass("ui-helper-hidden");this.reservationModif[b].stoQuantite=$("#qte-pdt-"+b+"-lot-"+c).text().numberFrToDb();this.majTotal()};this.changerProduit=function(b){var c=this;if($("#pdt-"+b).find(":checkbox").attr("checked")){$(".lot-pdt-"+b).show();$("[name=lot-produit-"+b+"]").each(function(){if($(this).attr("checked")){var e=$("#qte-pdt-"+b+"-lot-"+$(this).parent().parent().find(".lot-id").text()).text().numberFrToDb();if(c.reservationModif[b]){c.reservationModif[b].stoQuantite=e}else{var d={};d.comId=c.infoCommande.comId;d.proId=b;d.stoQuantite=e;c.reservationModif[b]=d}}})}else{$(".lot-pdt-"+b).hide();if(this.reservationModif[b]){this.reservationModif[b]=null}}this.majTotal()};this.majTotal=function(){$("#total").text(this.calculTotal().nombreFormate(2,","," "))};this.calculTotal=function(){var c=this;var b=0;$(this.reservationModif).each(function(){var d=this;if(d.stoQuantite){if(c.pdtCommande[d.proId]){$(c.pdtCommande[d.proId].lot).each(function(){if(d.stoQuantite%this.dcomTaille==0){b+=(d.stoQuantite/this.dcomTaille)*this.dcomPrix}})}}});return b};this.preparerAffichageModifier=function(b){var c=this;b.find(":checkbox:not(:checked)").each(function(){b.find(".lot-pdt-"+$(this).parent().parent().find(".pdt-id").text()).hide()});b.find(":radio:not(:checked)").each(function(){var e=$(this).parent().parent().find(".lot-id").text();var d=$(this).parent().parent().find(".pdt-id").text();b.find("#btn-moins-lot-"+e+",#btn-plus-lot-"+e).attr("disabled","disabled").addClass("ui-helper-hidden");b.find("#colonne-qte-pdt-"+d+"-lot-"+e+",#colonne-prix-pdt-"+d+"-lot-"+e+",#colonne-sigle-pdt-"+d+"-lot-"+e).addClass("ui-helper-hidden")});return b};this.validerReservation=function(){var e=this;Infobulle.init();var c=new ListeReservationCommandeVO();var f=0;$(this.reservationModif).each(function(){if(this.stoQuantite){var h=new ReservationCommandeVO();h.id="";h.stoQuantite=this.stoQuantite*-1;h.stoIdProduit=this.proId;c.commandes.push(h);f++}});if(f>0){var d=new ListeReservationCommandeValid();var g=d.validAjout(c);if(!g.valid){Infobulle.generer(g,"")}else{$.post("./index.php?m=MonCompte&v=AfficherReservation","reservation="+$.toJSON(c),function(h){Infobulle.init();if(h.valid){e.reservation=new Array();$(e.reservationModif).each(function(){if(this.proId){e.reservation[this.proId]={comId:this.comId,proId:this.proId,stoId:this.stoId,stoQuantite:this.stoQuantite,stoType:this.stoType,stoIdCompte:this.stoIdCompte}}});e.afficher()}else{Infobulle.generer(h,"")}},"json")}}else{var g=new TemplateVR();g.valid=false;g.log.valid=false;var b=new VRerreur();b.code=ERR_207_CODE;b.message=ERR_207_MSG;g.log.erreurs.push(b);Infobulle.generer(g,"")}};this.construct(a)}function ListeReservationVue(){this.construct=function(){var a=this;$.post("./index.php?m=MonCompte&v=ListeReservation",function(b){Infobulle.init();if(b.valid){a.afficher(b)}else{Infobulle.generer(b,"")}},"json")};this.afficher=function(c){var b=this;var e=new Object;e.reservation=new Array();$(c.reservations).each(function(){if(this.comNumero!=null){var f=new Object();f.numero=this.comNumero;f.dateFinReservation=this.comDateFinReservation.extractDbDate().dateDbToFr();f.heureFinReservation=this.comDateFinReservation.extractDbHeure();f.minuteFinReservation=this.comDateFinReservation.extractDbMinute();f.dateMarcheDebut=this.comDateMarcheDebut.extractDbDate().dateDbToFr();f.heureMarcheDebut=this.comDateMarcheDebut.extractDbHeure();f.minuteMarcheDebut=this.comDateMarcheDebut.extractDbMinute();f.heureMarcheFin=this.comDateMarcheFin.extractDbHeure();f.minuteMarcheFin=this.comDateMarcheFin.extractDbMinute();f.idCommande='"'+this.comId+'"';e.reservation.push(f)}});var a=new MonCompteTemplate();if(e.reservation.length>0){var d=a.listeReservation}else{var d=a.listeReservationVide}$("#contenu").replaceWith(b.affect($(d.template(e))))};this.affect=function(a){a=this.affectVisualiser(a);return a};this.affectVisualiser=function(a){a.find(".visualiser-reservation").click(function(){AfficherReservationVue($(this).attr("id"))});return a}}function ListeCommandeVue(){this.construct=function(){var a=this;$.post("./index.php?m=Commande&v=ListeCommande",function(b){Infobulle.init();if(b.valid){a.afficher(b)}else{Infobulle.generer(b,"")}},"json")};this.afficher=function(c){Infobulle.init();if(c.listeCommande[0]&&c.listeCommande[0].comDateFinReservation!=null){var b=this;var d=new Object;d.commande=new Array();$(c.listeCommande).each(function(){var h=new Object();h.id=this.comId;h.numero=this.comNumero;h.dateFinReservation=this.comDateFinReservation.extractDbDate().dateDbToFr();h.heureFinReservation=this.comDateFinReservation.extractDbHeure();h.minuteFinReservation=this.comDateFinReservation.extractDbMinute();h.dateMarcheDebut=this.comDateMarcheDebut.extractDbDate().dateDbToFr();h.heureMarcheDebut=this.comDateMarcheDebut.extractDbHeure();h.minuteMarcheDebut=this.comDateMarcheDebut.extractDbMinute();h.heureMarcheFin=this.comDateMarcheFin.extractDbHeure();h.minuteMarcheFin=this.comDateMarcheFin.extractDbMinute();d.commande.push(h)});var g=new CommandeTemplate();var e=g.listeCommandePage;$("#contenu").replaceWith(b.affect($(e.template(d))))}else{var f=new TemplateVR();f.valid=false;f.log.valid=false;var a=new VRerreur();a.code=ERR_219_CODE;a.message=ERR_219_MSG;f.log.erreurs.push(a);Infobulle.generer(f,"")}};this.affect=function(a){a=this.affectBtnCommander(a);return a};this.affectBtnCommander=function(a){a.find(".btn-commander").click(function(){ReservationCommandeVue($(this).attr("id"))});return a}}function ReservationCommandeVue(a){this.infoCommande=new Object();this.pdtCommande=new Array();this.reservation=new Array();this.construct=function(b){var c=this;$.post("./index.php?m=Commande&v=ReservationCommande","id_commande="+b,function(d){Infobulle.init();if(d.valid){c.infoCommande.comId=d.commande[0].comId;c.infoCommande.comNumero=d.commande[0].comNumero;c.infoCommande.comNom=d.commande[0].comNom;c.infoCommande.comDescription=d.commande[0].comDescription;c.infoCommande.dateTimeFinReservation=d.commande[0].comDateFinReservation;c.infoCommande.dateFinReservation=d.commande[0].comDateFinReservation.extractDbDate().dateDbToFr();c.infoCommande.heureFinReservation=d.commande[0].comDateFinReservation.extractDbHeure();c.infoCommande.minuteFinReservation=d.commande[0].comDateFinReservation.extractDbMinute();c.infoCommande.dateMarcheDebut=d.commande[0].comDateMarcheDebut.extractDbDate().dateDbToFr();c.infoCommande.heureMarcheDebut=d.commande[0].comDateMarcheDebut.extractDbHeure();c.infoCommande.minuteMarcheDebut=d.commande[0].comDateMarcheDebut.extractDbMinute();c.infoCommande.heureMarcheFin=d.commande[0].comDateMarcheFin.extractDbHeure();c.infoCommande.minuteMarcheFin=d.commande[0].comDateMarcheFin.extractDbMinute();c.infoCommande.comArchive=d.commande[0].comArchive;$(d.commande).each(function(){var f=new Object();f.dcomId=this.dcomId;f.dcomIdProduit=this.dcomIdProduit;f.dcomTaille=this.dcomTaille;f.dcomPrix=this.dcomPrix;if(c.pdtCommande[this.proId]){c.pdtCommande[this.proId].lot[f.dcomId]=f}else{var e=new Object();e.proId=this.proId;e.proUniteMesure=this.proUniteMesure;e.proMaxProduitCommande=this.proMaxProduitCommande;$(d.stock).each(function(){if(this.proId==e.proId){if(this.stoQuantite<e.proMaxProduitCommande){e.proMaxProduitCommande=this.stoQuantite}}});e.nproNom=this.nproNom;e.nproDescription=this.nproDescription;e.nproIdCategorie=this.nproIdCategorie;e.lot=new Array();e.lot[f.dcomId]=f;c.pdtCommande[e.proId]=e}});c.afficher()}else{Infobulle.generer(d,"")}},"json")};this.afficher=function(){this.afficherReservation()};this.afficherDetailCommande=function(){var d=this;var f=new CommandeTemplate();var e=f.detailReservation;var b=new Object();b.sigleMonetaire=gSigleMonetaire;b.comNumero=this.infoCommande.comNumero;b.dateFinReservation=this.infoCommande.dateFinReservation;b.heureFinReservation=this.infoCommande.heureFinReservation;b.minuteFinReservation=this.infoCommande.minuteFinReservation;b.dateMarcheDebut=this.infoCommande.dateMarcheDebut;b.heureMarcheDebut=this.infoCommande.heureMarcheDebut;b.minuteMarcheDebut=this.infoCommande.minuteMarcheDebut;b.heureMarcheFin=this.infoCommande.heureMarcheFin;b.minuteMarcheFin=this.infoCommande.minuteMarcheFin;b.reservation=new Array();var c=0;$(this.pdtCommande).each(function(){if(d.reservation[this.proId]){var g=new Object;g.nproNom=this.nproNom;g.stoQuantite=parseFloat(d.reservation[this.proId].stoQuantite);g.proUniteMesure=this.proUniteMesure;g.prix=0;$(this.lot).each(function(){if(g.stoQuantite%this.dcomTaille==0){g.prix=(g.stoQuantite/this.dcomTaille)*this.dcomPrix}});c+=g.prix;g.stoQuantite=g.stoQuantite.nombreFormate(2,","," ");g.prix=g.prix.nombreFormate(2,","," ");b.reservation.push(g)}});b.total=parseFloat(c).nombreFormate(2,","," ");$("#contenu").replaceWith(d.affect($(e.template(b))))};this.afficherReservation=function(){var d=this;var f=new CommandeTemplate();var e=f.reservation;var b={};b.sigleMonetaire=gSigleMonetaire;b.comNumero=this.infoCommande.comNumero;b.dateFinReservation=this.infoCommande.dateFinReservation;b.heureFinReservation=this.infoCommande.heureFinReservation;b.minuteFinReservation=this.infoCommande.minuteFinReservation;b.dateMarcheDebut=this.infoCommande.dateMarcheDebut;b.heureMarcheDebut=this.infoCommande.heureMarcheDebut;b.minuteMarcheDebut=this.infoCommande.minuteMarcheDebut;b.heureMarcheFin=this.infoCommande.heureMarcheFin;b.minuteMarcheFin=this.infoCommande.minuteMarcheFin;b.produit=new Array();var c=0;$(this.pdtCommande).each(function(){if(this.proId){var g={};g.proId=this.proId;g.nproNom=this.nproNom;g.proMaxProduitCommande=parseFloat(this.proMaxProduitCommande).nombreFormate(2,","," ");g.proUniteMesure=this.proUniteMesure;g.lot=new Array();var j=0;var h=-1;var k=-1;$(this.lot).each(function(){if(this.dcomId){var l={};l.dcomId=this.dcomId;l.dcomTaille=parseFloat(this.dcomTaille).nombreFormate(2,","," ");l.dcomPrix=parseFloat(this.dcomPrix).nombreFormate(2,","," ");l.prixReservation=parseFloat(this.dcomPrix);l.stoQuantiteReservation=parseFloat(this.dcomTaille);if(d.reservation[g.proId]&&(d.reservation[g.proId].stoQuantite%this.dcomTaille==0)){l.stoQuantiteReservation=parseFloat(d.reservation[g.proId].stoQuantite);l.prixReservation=(l.stoQuantiteReservation/this.dcomTaille)*this.dcomPrix;c+=l.prixReservation;h=this.dcomId;l.checked='checked="checked"'}l.stoQuantiteReservation=l.stoQuantiteReservation.nombreFormate(2,","," ");l.prixReservation=l.prixReservation.nombreFormate(2,","," ");g.lot.push(l)}});b.total=parseFloat(c).nombreFormate(2,","," ");if(h!=-1){g.checked='checked="checked"'}else{if(g.lot[0]){g.lot[0].checked='checked="checked"'}}b.produit.push(g)}});$("#contenu").replaceWith(d.affectModifier($(e.template(b))))};this.affect=function(b){b=this.affectModifierReservation(b);b=this.affectValiderReservation(b);return b};this.affectModifier=function(b){b=this.affectBtnQte(b);b=this.affectChangementLot(b);b=this.affectChangementProduit(b);b=this.preparerAffichageModifier(b);b=this.affectDetailReservation(b);return b};this.affectBtnQte=function(b){var c=this;b.find(".btn-plus").click(function(){c.nouvelleQuantite($(this).parent().parent().find(".pdt-id").text(),$(this).parent().parent().find(".lot-id").text(),1)});b.find(".btn-moins").click(function(){c.nouvelleQuantite($(this).parent().parent().find(".pdt-id").text(),$(this).parent().parent().find(".lot-id").text(),-1)});return b};this.affectChangementLot=function(b){var c=this;b.find(".lot").click(function(){$(this).find(":radio").attr("checked","checked");c.changerLot($(this).find(".pdt-id").text(),$(this).find(".lot-id").text())});return b};this.affectChangementProduit=function(b){var c=this;b.find(".pdt :checkbox").click(function(){c.changerProduit($(this).parent().parent().find(".pdt-id").text())});return b};this.affectModifierReservation=function(b){var c=this;b.find("#btn-modifier").click(function(){c.afficherReservation()});return b};this.affectDetailReservation=function(b){var c=this;b.find("#btn-valider").click(function(){c.validerReservation()});return b};this.affectValiderReservation=function(b){var c=this;b.find("#btn-valider").click(function(){c.enregistrerReservation()});return b};this.nouvelleQuantite=function(f,j,b){var g=this.pdtCommande[f].proMaxProduitCommande;var k=this.pdtCommande[f].lot[j].dcomTaille;var h=this.pdtCommande[f].lot[j].dcomPrix;var d=0;if(this.reservation[f]&&(this.reservation[f].stoQuantite%k==0)){d=this.reservation[f].stoQuantite/k}d+=b;var c=0;c=d*k;if(c>0&&c<=g){var e=0;e=d*h;this.reservation[f].stoQuantite=c;$("#qte-pdt-"+f+"-lot-"+j).text(parseFloat(c).nombreFormate(2,","," "));$("#prix-pdt-"+f+"-lot-"+j).text(parseFloat(e).nombreFormate(2,","," "));this.majTotal()}};this.changerLot=function(b,c){$(".btn-pdt-"+b).attr("disabled","disabled").addClass("ui-helper-hidden");$(".colonne-pdt-"+b).addClass("ui-helper-hidden");$("#btn-moins-lot-"+c+",#btn-plus-lot-"+c).removeAttr("disabled").removeClass("ui-helper-hidden");$("#colonne-qte-pdt-"+b+"-lot-"+c+",#colonne-prix-pdt-"+b+"-lot-"+c+",#colonne-sigle-pdt-"+b+"-lot-"+c).removeClass("ui-helper-hidden");this.reservation[b].stoQuantite=$("#qte-pdt-"+b+"-lot-"+c).text().numberFrToDb();this.majTotal()};this.changerProduit=function(b){var c=this;if($("#pdt-"+b).find(":checkbox").attr("checked")){$(".lot-pdt-"+b).show();$("[name=lot-produit-"+b+"]").each(function(){if($(this).attr("checked")){var e=$("#qte-pdt-"+b+"-lot-"+$(this).parent().parent().find(".lot-id").text()).text().numberFrToDb();if(c.reservation[b]){c.reservation[b].stoQuantite=e}else{var d={};d.comId=c.infoCommande.comId;d.proId=b;d.stoQuantite=e;c.reservation[b]=d}}})}else{$(".lot-pdt-"+b).hide();if(this.reservation[b]){this.reservation[b]=null}}this.majTotal()};this.majTotal=function(){$("#total").text(this.calculTotal().nombreFormate(2,","," "))};this.calculTotal=function(){var c=this;var b=0;$(this.reservation).each(function(){var d=this;if(d.stoQuantite){if(c.pdtCommande[d.proId]){$(c.pdtCommande[d.proId].lot).each(function(){if(d.stoQuantite%this.dcomTaille==0){b+=(d.stoQuantite/this.dcomTaille)*this.dcomPrix}})}}});return b};this.preparerAffichageModifier=function(b){var c=this;b.find(":checkbox:not(:checked)").each(function(){b.find(".lot-pdt-"+$(this).parent().parent().find(".pdt-id").text()).hide()});b.find(":radio:not(:checked)").each(function(){var e=$(this).parent().parent().find(".lot-id").text();var d=$(this).parent().parent().find(".pdt-id").text();b.find("#btn-moins-lot-"+e+",#btn-plus-lot-"+e).attr("disabled","disabled").addClass("ui-helper-hidden");b.find("#colonne-qte-pdt-"+d+"-lot-"+e+",#colonne-prix-pdt-"+d+"-lot-"+e+",#colonne-sigle-pdt-"+d+"-lot-"+e).addClass("ui-helper-hidden")});return b};this.validerReservation=function(){Infobulle.init();var b=this.genererListeReservation();var c=this.verifierReservation(b);if(c.valid){this.afficherDetailCommande()}else{Infobulle.generer(c,"")}};this.enregistrerReservation=function(){Infobulle.init();var c=this;var b=this.genererListeReservation();var d=this.verifierReservation(b);if(d.valid){$.post("./index.php?m=Commande&v=ReservationCommande","reservation="+$.toJSON(b),function(e){Infobulle.init();if(e.valid){c.afficherRetour()}else{Infobulle.generer(e,"")}},"json")}else{Infobulle.generer(d,"")}};this.genererListeReservation=function(){var b=new ListeReservationCommandeVO();$(this.reservation).each(function(){if(this.stoQuantite){var c=new ReservationCommandeVO();c.id="";c.stoQuantite=this.stoQuantite*-1;c.stoIdProduit=this.proId;b.commandes.push(c)}});return b};this.verifierReservation=function(d){if($(d.commandes).length>0){var c=new ListeReservationCommandeValid();var e=c.validAjout(d)}else{var e=new TemplateVR();e.valid=false;e.log.valid=false;var b=new VRerreur();b.code=ERR_207_CODE;b.message=ERR_207_MSG;e.log.erreurs.push(b)}return e};this.afficherRetour=function(){var b=new CommandeTemplate();$("#contenu").replaceWith(b.reservationOk)};this.construct(a)};